<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CP3501 ‚Äî Week 5: NLP & Transformers</title>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;900&family=Source+Sans+3:wght@300;400;600;700&family=JetBrains+Mono:wght@400;600&display=swap" rel="stylesheet">
<style>
  :root {
    --red: #C8102E;
    --red-light: #f8e8eb;
    --dark: #1a1a2e;
    --mid: #4a4a6a;
    --soft: #f4f4f8;
    --white: #ffffff;
    --border: #e0e0e8;
    --accent: #2d6a9f;
    --accent-light: #e8f2fb;
    --green: #1a7a4a;
    --green-light: #e8f7ef;
    --amber: #c47a00;
    --amber-light: #fdf3e0;
  }

  * { box-sizing: border-box; margin: 0; padding: 0; }

  body {
    font-family: 'Source Sans 3', sans-serif;
    background: #e8e8ef;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    min-height: 100vh;
    padding: 20px;
  }

  /* ‚îÄ‚îÄ SLIDE CONTAINER ‚îÄ‚îÄ */
  .deck {
    position: relative;
    width: 100%;
    max-width: 960px;
  }

  .slide {
    display: none;
    background: var(--white);
    border-radius: 4px;
    box-shadow: 0 4px 40px rgba(0,0,0,0.12);
    min-height: 560px;
    padding: 56px 64px 72px;
    position: relative;
    overflow: hidden;
    animation: fadeIn .3s ease;
  }

  .slide.active { display: flex; flex-direction: column; }

  @keyframes fadeIn { from { opacity:0; transform:translateY(6px); } to { opacity:1; transform:translateY(0); } }

  /* ‚îÄ‚îÄ TOP BAR ‚îÄ‚îÄ */
  .slide-bar {
    position: absolute;
    top: 0; left: 0; right: 0;
    height: 5px;
    background: var(--red);
  }

  .slide-tag {
    position: absolute;
    top: 18px; right: 24px;
    font-size: 11px;
    font-weight: 700;
    letter-spacing: 2px;
    text-transform: uppercase;
    color: var(--red);
  }

  .slide-num {
    position: absolute;
    bottom: 20px; right: 24px;
    font-size: 12px;
    color: #aaa;
    font-weight: 600;
  }

  /* ‚îÄ‚îÄ TITLE SLIDE ‚îÄ‚îÄ */
  .title-slide {
    justify-content: center;
  }
  .title-slide .kicker {
    font-size: 12px;
    font-weight: 700;
    letter-spacing: 3px;
    text-transform: uppercase;
    color: var(--red);
    margin-bottom: 20px;
  }
  .title-slide h1 {
    font-family: 'Playfair Display', serif;
    font-size: 52px;
    line-height: 1.1;
    color: var(--dark);
    margin-bottom: 24px;
  }
  .title-slide .subtitle {
    font-size: 20px;
    color: var(--mid);
    font-weight: 300;
    max-width: 520px;
    line-height: 1.5;
    margin-bottom: 40px;
  }
  .title-meta {
    display: flex;
    gap: 32px;
  }
  .title-meta span {
    font-size: 13px;
    color: #999;
    font-weight: 600;
    letter-spacing: 1px;
    text-transform: uppercase;
  }
  .title-accent {
    position: absolute;
    bottom: 0; right: 0;
    width: 280px; height: 280px;
    background: var(--red-light);
    border-radius: 50%;
    transform: translate(40%, 40%);
    z-index: 0;
  }

  /* ‚îÄ‚îÄ GENERAL TYPOGRAPHY ‚îÄ‚îÄ */
  h2 {
    font-family: 'Playfair Display', serif;
    font-size: 36px;
    color: var(--dark);
    line-height: 1.15;
    margin-bottom: 32px;
  }
  h3 {
    font-size: 14px;
    font-weight: 700;
    letter-spacing: 2px;
    text-transform: uppercase;
    color: var(--red);
    margin-bottom: 16px;
  }
  p {
    font-size: 17px;
    color: var(--mid);
    line-height: 1.65;
  }

  /* ‚îÄ‚îÄ BULLET LIST ‚îÄ‚îÄ */
  .bullets {
    list-style: none;
    display: flex;
    flex-direction: column;
    gap: 16px;
    margin-top: 4px;
  }
  .bullets li {
    display: flex;
    align-items: flex-start;
    gap: 14px;
    font-size: 17px;
    color: var(--mid);
    line-height: 1.55;
  }
  .bullets li::before {
    content: '';
    display: block;
    flex-shrink: 0;
    width: 8px; height: 8px;
    background: var(--red);
    border-radius: 50%;
    margin-top: 8px;
  }
  .bullets li strong { color: var(--dark); font-weight: 700; }

  /* ‚îÄ‚îÄ CALLOUT BOXES ‚îÄ‚îÄ */
  .callout {
    border-left: 4px solid var(--red);
    background: var(--red-light);
    padding: 16px 20px;
    border-radius: 0 6px 6px 0;
    margin-top: 24px;
  }
  .callout p { font-size: 16px; color: var(--dark); }
  .callout-blue {
    border-left: 4px solid var(--accent);
    background: var(--accent-light);
  }
  .callout-blue p { color: var(--dark); }
  .callout-green {
    border-left: 4px solid var(--green);
    background: var(--green-light);
  }
  .callout-amber {
    border-left: 4px solid var(--amber);
    background: var(--amber-light);
  }

  /* ‚îÄ‚îÄ TWO COLUMN ‚îÄ‚îÄ */
  .two-col {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 32px;
    margin-top: 8px;
  }
  .col-card {
    background: var(--soft);
    border-radius: 8px;
    padding: 24px;
  }
  .col-card h4 {
    font-size: 14px;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 1.5px;
    color: var(--red);
    margin-bottom: 14px;
  }
  .col-card .bullets li { font-size: 15px; }

  /* ‚îÄ‚îÄ TABLE ‚îÄ‚îÄ */
  .data-table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 16px;
    font-size: 15px;
  }
  .data-table th {
    background: var(--dark);
    color: white;
    padding: 10px 16px;
    text-align: left;
    font-weight: 700;
    font-size: 12px;
    letter-spacing: 1px;
    text-transform: uppercase;
  }
  .data-table td {
    padding: 10px 16px;
    color: var(--mid);
    border-bottom: 1px solid var(--border);
  }
  .data-table tr:nth-child(even) td { background: var(--soft); }
  .data-table td strong { color: var(--dark); }
  .data-table .highlight td { background: var(--red-light) !important; }
  .data-table .highlight td strong { color: var(--red); }

  /* ‚îÄ‚îÄ PIPELINE FLOW ‚îÄ‚îÄ */
  .pipeline {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-top: 32px;
    flex-wrap: wrap;
  }
  .pipe-step {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 8px;
  }
  .pipe-box {
    background: var(--dark);
    color: white;
    padding: 10px 16px;
    border-radius: 6px;
    font-size: 13px;
    font-weight: 700;
    text-align: center;
    white-space: nowrap;
  }
  .pipe-box.red { background: var(--red); }
  .pipe-box.blue { background: var(--accent); }
  .pipe-box.green { background: var(--green); }
  .pipe-box.amber { background: var(--amber); }
  .pipe-label {
    font-size: 11px;
    color: #999;
    text-align: center;
    max-width: 100px;
    line-height: 1.3;
  }
  .pipe-arrow {
    font-size: 22px;
    color: #ccc;
    line-height: 1;
    margin-bottom: 20px;
  }

  /* ‚îÄ‚îÄ COMPARISON CARD ‚îÄ‚îÄ */
  .compare-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;
    margin-top: 20px;
  }
  .compare-card {
    border-radius: 8px;
    padding: 20px 24px;
    border: 2px solid var(--border);
  }
  .compare-card.active-card {
    border-color: var(--red);
    background: var(--red-light);
  }
  .compare-card h4 {
    font-size: 18px;
    font-weight: 700;
    color: var(--dark);
    margin-bottom: 14px;
  }
  .compare-card.active-card h4 { color: var(--red); }

  /* ‚îÄ‚îÄ NUMBERED STEPS ‚îÄ‚îÄ */
  .steps {
    display: flex;
    flex-direction: column;
    gap: 16px;
    margin-top: 8px;
  }
  .step {
    display: flex;
    align-items: flex-start;
    gap: 16px;
  }
  .step-num {
    flex-shrink: 0;
    width: 34px; height: 34px;
    background: var(--red);
    color: white;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 700;
    font-size: 14px;
    margin-top: 2px;
  }
  .step-content strong {
    display: block;
    font-size: 16px;
    font-weight: 700;
    color: var(--dark);
    margin-bottom: 2px;
  }
  .step-content span {
    font-size: 15px;
    color: var(--mid);
    line-height: 1.5;
  }

  /* ‚îÄ‚îÄ BIG STAT ‚îÄ‚îÄ */
  .big-stat {
    display: flex;
    align-items: baseline;
    gap: 12px;
    margin: 24px 0;
  }
  .big-stat .num {
    font-family: 'Playfair Display', serif;
    font-size: 72px;
    color: var(--red);
    line-height: 1;
  }
  .big-stat .label {
    font-size: 20px;
    color: var(--mid);
    font-weight: 300;
    max-width: 240px;
    line-height: 1.4;
  }

  /* ‚îÄ‚îÄ TOKEN DEMO ‚îÄ‚îÄ */
  .token-row {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
    margin-top: 12px;
  }
  .token {
    background: var(--accent-light);
    border: 1.5px solid var(--accent);
    color: var(--accent);
    padding: 4px 10px;
    border-radius: 4px;
    font-family: 'JetBrains Mono', monospace;
    font-size: 13px;
    font-weight: 600;
  }
  .token.special {
    background: var(--red-light);
    border-color: var(--red);
    color: var(--red);
  }
  .token.id {
    background: var(--green-light);
    border-color: var(--green);
    color: var(--green);
    font-size: 11px;
  }

  /* ‚îÄ‚îÄ INTERLUDE BANNER ‚îÄ‚îÄ */
  .interlude {
    background: var(--dark);
    color: white;
    padding: 24px 32px;
    border-radius: 8px;
    margin-bottom: 28px;
    display: flex;
    align-items: center;
    gap: 16px;
  }
  .interlude .icon { font-size: 28px; }
  .interlude p { font-size: 16px; color: #ccc; }
  .interlude strong { color: white; font-size: 18px; display: block; margin-bottom: 4px; }

  /* ‚îÄ‚îÄ CONTROLS ‚îÄ‚îÄ */
  .controls {
    display: flex;
    align-items: center;
    justify-content: space-between;
    width: 100%;
    max-width: 960px;
    margin-top: 20px;
  }
  .btn {
    background: var(--white);
    border: 2px solid var(--border);
    padding: 10px 28px;
    border-radius: 6px;
    font-family: 'Source Sans 3', sans-serif;
    font-size: 14px;
    font-weight: 700;
    cursor: pointer;
    transition: all .2s;
    color: var(--dark);
  }
  .btn:hover { border-color: var(--red); color: var(--red); }
  .btn:disabled { opacity: .3; cursor: default; }
  .btn.primary { background: var(--red); color: white; border-color: var(--red); }
  .btn.primary:hover { background: #a50d25; border-color: #a50d25; }

  .progress-bar {
    flex: 1;
    margin: 0 20px;
    height: 4px;
    background: var(--border);
    border-radius: 2px;
    overflow: hidden;
  }
  .progress-fill {
    height: 100%;
    background: var(--red);
    border-radius: 2px;
    transition: width .3s ease;
  }
  .progress-text {
    font-size: 13px;
    font-weight: 700;
    color: #aaa;
    white-space: nowrap;
  }

  /* ‚îÄ‚îÄ SVG DIAGRAMS ‚îÄ‚îÄ */
  .diagram { margin-top: 24px; }

  /* ‚îÄ‚îÄ EMOJI HEADLINE ‚îÄ‚îÄ */
  .emoji-head {
    font-size: 40px;
    margin-bottom: 12px;
    display: block;
  }

  /* ‚îÄ‚îÄ VOCAB TABLE ‚îÄ‚îÄ */
  .vocab-grid {
    display: grid;
    grid-template-columns: 1fr 1fr 1fr;
    gap: 16px;
    margin-top: 20px;
  }
  .vocab-card {
    background: var(--soft);
    border-radius: 8px;
    padding: 18px;
    border-top: 3px solid var(--border);
  }
  .vocab-card.v-char { border-top-color: var(--accent); }
  .vocab-card.v-word { border-top-color: var(--amber); }
  .vocab-card.v-sub  { border-top-color: var(--green); }
  .vocab-card h5 {
    font-size: 13px;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 1.5px;
    margin-bottom: 10px;
  }
  .vocab-card.v-char h5 { color: var(--accent); }
  .vocab-card.v-word h5 { color: var(--amber); }
  .vocab-card.v-sub  h5 { color: var(--green); }
  .vocab-card p { font-size: 14px; line-height: 1.5; }

  /* ‚îÄ‚îÄ SPLIT BOXES ‚îÄ‚îÄ */
  .split-boxes {
    display: flex;
    gap: 16px;
    margin-top: 20px;
  }
  .split-box {
    flex: 1;
    border-radius: 8px;
    padding: 20px;
    text-align: center;
  }
  .split-box h4 {
    font-size: 14px;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 1px;
    margin-bottom: 8px;
  }
  .split-box p { font-size: 14px; line-height: 1.5; }
  .sb-train { background: var(--accent-light); }
  .sb-train h4 { color: var(--accent); }
  .sb-val   { background: var(--amber-light); }
  .sb-val h4   { color: var(--amber); }
  .sb-test  { background: var(--red-light); }
  .sb-test h4  { color: var(--red); }

  /* ‚îÄ‚îÄ PEARSON DEMO ‚îÄ‚îÄ */
  .pearson-table {
    width: 100%;
    border-collapse: collapse;
    font-size: 15px;
    margin-top: 16px;
  }
  .pearson-table th {
    background: var(--dark);
    color: white;
    padding: 8px 14px;
    text-align: center;
    font-size: 12px;
    text-transform: uppercase;
    letter-spacing: 1px;
  }
  .pearson-table td {
    padding: 8px 14px;
    text-align: center;
    border-bottom: 1px solid var(--border);
    color: var(--mid);
  }
  .pearson-table tr:nth-child(even) td { background: var(--soft); }
  .pearson-table .outlier td { background: #fff0f0; color: var(--red); font-weight: 700; }

  /* ‚îÄ‚îÄ ETHICS PILL ‚îÄ‚îÄ */
  .ethics-pills {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    margin-top: 20px;
  }
  .ethics-pill {
    background: var(--soft);
    border: 1.5px solid var(--border);
    border-radius: 24px;
    padding: 8px 18px;
    font-size: 14px;
    color: var(--mid);
    font-weight: 600;
  }
  .ethics-pill.risk {
    background: var(--red-light);
    border-color: var(--red);
    color: var(--red);
  }
  .ethics-pill.ok {
    background: var(--green-light);
    border-color: var(--green);
    color: var(--green);
  }

  /* ‚îÄ‚îÄ SLIDE-SPECIFIC OVERRIDES ‚îÄ‚îÄ */
  .wide-p { max-width: 680px; }
  .mt-8  { margin-top: 8px; }
  .mt-16 { margin-top: 16px; }
  .mt-24 { margin-top: 24px; }
  .mb-8  { margin-bottom: 8px; }

  .section-label {
    display: inline-block;
    background: var(--red);
    color: white;
    font-size: 11px;
    font-weight: 700;
    letter-spacing: 2px;
    text-transform: uppercase;
    padding: 4px 10px;
    border-radius: 3px;
    margin-bottom: 18px;
  }
  .section-label.blue { background: var(--accent); }
  .section-label.green { background: var(--green); }
  .section-label.amber { background: var(--amber); }
  .section-label.dark { background: var(--dark); }

</style>
</head>
<body>

<div class="deck">

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SLIDE 1 -->
  <div class="slide active title-slide">
    <div class="slide-bar"></div>
    <div style="position:relative;z-index:1">
      <div class="kicker">CP3501 Deep Learning ¬∑ Week 5</div>
      <h1>Natural Language<br>Processing &<br>Transformers</h1>
      <p class="subtitle">From text to predictions ‚Äî using pretrained models to solve real-world NLP tasks</p>
      <div class="title-meta">
        <span>FastAI Lesson 4</span>
        <span>Hugging Face Transformers</span>
        <span>JCU Brisbane</span>
      </div>
    </div>
    <div class="title-accent"></div>
    <div class="slide-num">1 / 40</div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SLIDE 2 -->
  <div class="slide">
    <div class="slide-bar"></div>
    <div class="slide-tag">Recap</div>
    <h3>Where We've Been</h3>
    <h2>The Deep Learning Recipe</h2>
    <p class="wide-p">Every deep learning task we've seen shares the same core loop ‚Äî only the input data changes.</p>
    <div class="pipeline">
      <div class="pipe-step">
        <div class="pipe-box red">Raw Data</div>
        <div class="pipe-label">images, tables, or text</div>
      </div>
      <div class="pipe-arrow">‚Üí</div>
      <div class="pipe-step">
        <div class="pipe-box blue">Preprocess</div>
        <div class="pipe-label">turn data into numbers</div>
      </div>
      <div class="pipe-arrow">‚Üí</div>
      <div class="pipe-step">
        <div class="pipe-box">Model</div>
        <div class="pipe-label">learns patterns from numbers</div>
      </div>
      <div class="pipe-arrow">‚Üí</div>
      <div class="pipe-step">
        <div class="pipe-box green">Prediction</div>
        <div class="pipe-label">a useful output</div>
      </div>
    </div>
    <div class="callout mt-24">
      <p><strong>The key insight:</strong> The training loop ‚Äî forward pass, compute loss, backpropagate, update weights ‚Äî is identical whether you're classifying cat photos or analysing legal documents.</p>
    </div>
    <div class="slide-num">2 / 40</div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SLIDE 3 -->
  <div class="slide">
    <div class="slide-bar"></div>
    <div class="slide-tag">Recap</div>
    <h3>Data Types</h3>
    <h2>Three Modalities, Same Principles</h2>
    <table class="data-table mt-8">
      <tr>
        <th>Data type</th>
        <th>Raw form</th>
        <th>Preprocessing</th>
        <th>Model type</th>
      </tr>
      <tr>
        <td><strong>Vision</strong></td>
        <td>Image files</td>
        <td>Resize ‚Üí pixel values</td>
        <td>CNN</td>
      </tr>
      <tr>
        <td><strong>Tabular</strong></td>
        <td>CSV rows</td>
        <td>Normalise, one-hot encode</td>
        <td>Linear + ReLU layers</td>
      </tr>
      <tr class="highlight">
        <td><strong>Text ‚Üê Today</strong></td>
        <td>Sentences</td>
        <td>Tokenise ‚Üí integer IDs</td>
        <td>Transformer</td>
      </tr>
    </table>
    <div class="callout-blue callout mt-24">
      <p><strong>Same loss function. Same gradient descent. Same optimiser.</strong> Text just needs a different kind of preprocessing before the numbers go in.</p>
    </div>
    <div class="slide-num">3 / 40</div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SLIDE 4 -->
  <div class="slide">
    <div class="slide-bar"></div>
    <div class="slide-tag">Library Switch</div>
    <h3>Tools</h3>
    <h2>Why We're Switching to Hugging Face</h2>
    <div class="compare-grid">
      <div class="compare-card">
        <h4>fastai (Lessons 1‚Äì3)</h4>
        <ul class="bullets">
          <li>Very high-level ‚Äî one function does a lot</li>
          <li>Great for vision and tabular data</li>
          <li>Ideal for building intuition quickly</li>
        </ul>
      </div>
      <div class="compare-card active-card">
        <h4>ü§ó Hugging Face (Today)</h4>
        <ul class="bullets">
          <li>Mid-level ‚Äî you see each step clearly</li>
          <li>Best-in-class NLP models</li>
          <li>The industry standard for text AI</li>
        </ul>
      </div>
    </div>
    <div class="callout mt-24">
      <p><strong>Why both matter:</strong> Seeing the same ideas expressed in two different libraries deepens understanding. fastai integrates Hugging Face models anyway ‚Äî skills transfer both ways.</p>
    </div>
    <div class="slide-num">4 / 40</div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SLIDE 5 -->
  <div class="slide">
    <div class="slide-bar"></div>
    <div class="slide-tag">Library Switch</div>
    <h3>Translation Guide</h3>
    <h2>fastai ‚Üí Hugging Face: What Maps to What</h2>
    <p>Everything you learned still applies. The concepts have new names.</p>
    <table class="data-table mt-16">
      <tr>
        <th>fastai concept</th>
        <th>Hugging Face equivalent</th>
        <th>What it does</th>
      </tr>
      <tr><td><strong>DataBlock</strong></td><td>Dataset + .map()</td><td>Prepares and transforms data</td></tr>
      <tr><td><strong>Learner</strong></td><td>Trainer</td><td>Bundles model, data, loss, metrics</td></tr>
      <tr><td><strong>fit_one_cycle()</strong></td><td>TrainingArguments (cosine + warmup)</td><td>Runs the training loop</td></tr>
      <tr><td><strong>learn.predict()</strong></td><td>trainer.predict()</td><td>Gets predictions from a trained model</td></tr>
      <tr><td><strong>fine_tune()</strong></td><td>trainer.train()</td><td>Adapts pretrained weights to your task</td></tr>
    </table>
    <div class="slide-num">5 / 40</div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SLIDE 6 -->
  <div class="slide">
    <div class="slide-bar"></div>
    <div class="slide-tag">NLP Foundations</div>
    <h3>What Is NLP?</h3>
    <h2>Teaching Computers to Work with Language</h2>
    <p class="wide-p">Natural Language Processing (NLP) is the field of making computers understand, generate, and work with human text and speech.</p>
    <div class="two-col mt-24">
      <div class="col-card">
        <h4>Tasks NLP can solve</h4>
        <ul class="bullets">
          <li>Is this review <strong>positive or negative?</strong></li>
          <li>Is this email <strong>spam?</strong></li>
          <li>Do these two sentences <strong>mean the same thing?</strong></li>
          <li>Who <strong>wrote</strong> this document?</li>
        </ul>
      </div>
      <div class="col-card">
        <h4>Why it's hard</h4>
        <ul class="bullets">
          <li>The same word means different things in different contexts</li>
          <li>Sarcasm, idioms, abbreviations</li>
          <li>Computers need numbers ‚Äî not words</li>
        </ul>
      </div>
    </div>
    <div class="slide-num">6 / 40</div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SLIDE 7 -->
  <div class="slide">
    <div class="slide-bar"></div>
    <div class="slide-tag">NLP Foundations</div>
    <h3>The Pipeline</h3>
    <h2>How Text Becomes a Prediction</h2>
    <p>Every NLP model follows this sequence. We'll build each step today.</p>
    <div style="margin-top:32px; overflow-x:auto;">
      <svg viewBox="0 0 820 160" xmlns="http://www.w3.org/2000/svg" style="width:100%;max-width:820px">
        <!-- Boxes -->
        <rect x="0"   y="40" width="130" height="60" rx="6" fill="#1a1a2e"/>
        <rect x="175" y="40" width="130" height="60" rx="6" fill="#C8102E"/>
        <rect x="350" y="40" width="130" height="60" rx="6" fill="#2d6a9f"/>
        <rect x="525" y="40" width="130" height="60" rx="6" fill="#2d6a9f"/>
        <rect x="700" y="40" width="120" height="60" rx="6" fill="#1a7a4a"/>
        <!-- Arrows -->
        <path d="M130 70 L175 70" stroke="#ccc" stroke-width="2" marker-end="url(#arr)"/>
        <path d="M305 70 L350 70" stroke="#ccc" stroke-width="2" marker-end="url(#arr)"/>
        <path d="M480 70 L525 70" stroke="#ccc" stroke-width="2" marker-end="url(#arr)"/>
        <path d="M655 70 L700 70" stroke="#ccc" stroke-width="2" marker-end="url(#arr)"/>
        <defs><marker id="arr" markerWidth="8" markerHeight="8" refX="6" refY="3" orient="auto"><path d="M0,0 L0,6 L8,3 z" fill="#ccc"/></marker></defs>
        <!-- Labels inside -->
        <text x="65"  y="65" text-anchor="middle" fill="white" font-family="Source Sans 3" font-size="13" font-weight="700">Raw Text</text>
        <text x="240" y="62" text-anchor="middle" fill="white" font-family="Source Sans 3" font-size="13" font-weight="700">Tokeniser</text>
        <text x="240" y="80" text-anchor="middle" fill="white" font-family="Source Sans 3" font-size="11">‚Üí integer IDs</text>
        <text x="415" y="62" text-anchor="middle" fill="white" font-family="Source Sans 3" font-size="13" font-weight="700">Embedding</text>
        <text x="415" y="80" text-anchor="middle" fill="white" font-family="Source Sans 3" font-size="11">Matrix (learned)</text>
        <text x="590" y="62" text-anchor="middle" fill="white" font-family="Source Sans 3" font-size="13" font-weight="700">Transformer</text>
        <text x="590" y="80" text-anchor="middle" fill="white" font-family="Source Sans 3" font-size="11">Layers</text>
        <text x="760" y="62" text-anchor="middle" fill="white" font-family="Source Sans 3" font-size="13" font-weight="700">Classifier</text>
        <text x="760" y="80" text-anchor="middle" fill="white" font-family="Source Sans 3" font-size="11">Head</text>
        <!-- Shape annotations -->
        <text x="65"  y="125" text-anchor="middle" fill="#888" font-family="JetBrains Mono" font-size="11">"table leg"</text>
        <text x="240" y="125" text-anchor="middle" fill="#888" font-family="JetBrains Mono" font-size="11">[1, 54453, 435‚Ä¶]</text>
        <text x="415" y="125" text-anchor="middle" fill="#888" font-family="JetBrains Mono" font-size="11">[128 √ó 768]</text>
        <text x="590" y="125" text-anchor="middle" fill="#888" font-family="JetBrains Mono" font-size="11">[128 √ó 768]</text>
        <text x="760" y="125" text-anchor="middle" fill="#888" font-family="JetBrains Mono" font-size="11">[1 score]</text>
      </svg>
    </div>
    <div class="callout-blue callout" style="margin-top:20px">
      <p>The numbers in brackets show the <strong>shape of the data</strong> as it flows through. 128 = sequence length. 768 = hidden size of BERT-base.</p>
    </div>
    <div class="slide-num">7 / 40</div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SLIDE 8 -->
  <div class="slide">
    <div class="slide-bar"></div>
    <div class="slide-tag">NLP Foundations</div>
    <h3>Preprocessing</h3>
    <h2>Why Text Needs Tokenisation</h2>
    <p class="wide-p">Neural networks only work with numbers. We need a reliable way to convert any string of text into a fixed list of integers. This process is called <strong>tokenisation</strong>.</p>
    <div class="steps mt-24">
      <div class="step">
        <div class="step-num">1</div>
        <div class="step-content">
          <strong>Split the text into pieces called tokens</strong>
          <span>A token is roughly a word, part of a word, or a punctuation mark</span>
        </div>
      </div>
      <div class="step">
        <div class="step-num">2</div>
        <div class="step-content">
          <strong>Look up each token's ID in the vocabulary</strong>
          <span>Every model has a vocabulary ‚Äî a dictionary mapping token ‚Üí number</span>
        </div>
      </div>
      <div class="step">
        <div class="step-num">3</div>
        <div class="step-content">
          <strong>Pad or truncate to a fixed length</strong>
          <span>All inputs must be the same length so they can be processed in batches</span>
        </div>
      </div>
    </div>
    <div class="slide-num">8 / 40</div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SLIDE 9 -->
  <div class="slide">
    <div class="slide-bar"></div>
    <div class="slide-tag">NLP Foundations</div>
    <h3>Vocabulary Design</h3>
    <h2>The Problem with Using Whole Words</h2>
    <p>There are over a million English words. If each word gets its own ID, the vocabulary becomes impossibly large.</p>
    <div class="vocab-grid">
      <div class="vocab-card v-char">
        <h5>Character-level</h5>
        <p>Split into individual letters.<br>Tiny vocabulary (~100) but loses meaning ‚Äî 'c','a','t' doesn't tell you it's an animal.</p>
      </div>
      <div class="vocab-card v-word">
        <h5>Word-level</h5>
        <p>Keep whole words. "Unbelievable" gets its own slot. Problem: new or rare words have no ID ‚Äî <em>out-of-vocabulary</em>.</p>
      </div>
      <div class="vocab-card v-sub">
        <h5>Sub-word ‚úì Best</h5>
        <p>Split at meaningful boundaries. "unbelievable" ‚Üí "un" + "believ" + "able". Handles new words, manageable vocabulary (~30k).</p>
      </div>
    </div>
    <div class="callout-green callout mt-16">
      <p><strong>Modern NLP uses sub-word tokenisation.</strong> BERT uses WordPiece. GPT uses BPE (Byte-Pair Encoding). Both give small vocabularies that handle any text.</p>
    </div>
    <div class="slide-num">9 / 40</div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SLIDE 10 -->
  <div class="slide">
    <div class="slide-bar"></div>
    <div class="slide-tag">NLP Foundations</div>
    <h3>Sub-word Demo</h3>
    <h2>Watching the Tokeniser Work</h2>
    <p>The underscore ( _ ) marks the start of a new word. Everything without an underscore is a continuation.</p>

    <div style="margin-top:28px">
      <p style="font-size:14px;font-weight:700;text-transform:uppercase;letter-spacing:1px;color:#999;margin-bottom:10px">Input ‚Üí "Good AI from fast.ai"</p>
      <div class="token-row">
        <div class="token">_Good</div>
        <div class="token">_A</div>
        <div class="token">I</div>
        <div class="token">_from</div>
        <div class="token">_fast</div>
        <div class="token">.</div>
        <div class="token">ai</div>
      </div>
    </div>

    <div style="margin-top:24px">
      <p style="font-size:14px;font-weight:700;text-transform:uppercase;letter-spacing:1px;color:#999;margin-bottom:10px">Input ‚Üí "A platypus is an ornithorhynchus"</p>
      <div class="token-row">
        <div class="token">_A</div>
        <div class="token">_platypus</div>
        <div class="token">_is</div>
        <div class="token">_an</div>
        <div class="token">_or</div>
        <div class="token">nith</div>
        <div class="token">or</div>
        <div class="token">hyn</div>
        <div class="token">chus</div>
      </div>
    </div>

    <div style="margin-top:24px">
      <p style="font-size:14px;font-weight:700;text-transform:uppercase;letter-spacing:1px;color:#999;margin-bottom:10px">Those tokens become integer IDs</p>
      <div class="token-row">
        <div class="token id">1</div>
        <div class="token id">54453</div>
        <div class="token id">435</div>
        <div class="token id">294</div>
        <div class="token id">336</div>
        <div class="token id">5753</div>
        <div class="token id">346</div>
        <div class="token id">2</div>
      </div>
    </div>
    <div class="slide-num">10 / 40</div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SLIDE 11 -->
  <div class="slide">
    <div class="slide-bar"></div>
    <div class="slide-tag">Pretraining</div>
    <h3>How BERT Learned Language</h3>
    <h2>The Masked Language Model Trick</h2>
    <p class="wide-p">BERT was trained on hundreds of millions of sentences from Wikipedia and books ‚Äî with zero human labels. Here's how:</p>
    <div class="steps mt-24">
      <div class="step">
        <div class="step-num">1</div>
        <div class="step-content">
          <strong>Take a normal sentence</strong>
          <span>"The patient was admitted to the hospital with chest pain."</span>
        </div>
      </div>
      <div class="step">
        <div class="step-num">2</div>
        <div class="step-content">
          <strong>Randomly hide 15% of the words</strong>
          <span>"The patient was admitted to the [MASK] with chest pain."</span>
        </div>
      </div>
      <div class="step">
        <div class="step-num">3</div>
        <div class="step-content">
          <strong>Train the model to predict the hidden words</strong>
          <span>To predict "hospital", the model must learn grammar, facts, and context</span>
        </div>
      </div>
    </div>
    <div class="callout mt-16">
      <p><strong>Result:</strong> After seeing billions of sentences, BERT's weights encode rich knowledge about language, facts, and meaning ‚Äî ready to be fine-tuned for your specific task.</p>
    </div>
    <div class="slide-num">11 / 40</div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SLIDE 12 -->
  <div class="slide">
    <div class="slide-bar"></div>
    <div class="slide-tag">Pretraining</div>
    <h3>Fine-tuning</h3>
    <h2>Small, Focused Edits ‚Äî Not Starting from Scratch</h2>
    <p class="wide-p">Fine-tuning takes a pretrained model and gently adjusts its weights for your specific task. Most weights barely change.</p>
    <div class="two-col mt-24">
      <div class="col-card">
        <h4>Training from scratch</h4>
        <ul class="bullets">
          <li>All weights start <strong>random</strong></li>
          <li>Needs millions of labelled examples</li>
          <li>Takes days or weeks to train</li>
          <li>Requires huge compute budget</li>
        </ul>
      </div>
      <div class="col-card" style="background:var(--red-light);border:2px solid var(--red)">
        <h4 style="color:var(--red)">Fine-tuning ‚úì What we do</h4>
        <ul class="bullets">
          <li>Weights start <strong>already good</strong> from pretraining</li>
          <li>Works with a few thousand examples</li>
          <li>Takes minutes on a free GPU</li>
          <li>State-of-the-art results</li>
        </ul>
      </div>
    </div>
    <div class="slide-num">12 / 40</div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SLIDE 13 -->
  <div class="slide">
    <div class="slide-bar"></div>
    <div class="slide-tag">Today's Task</div>
    <h3>The Problem</h3>
    <h2>Kaggle: US Patent Phrase-to-Phrase Matching</h2>
    <p class="wide-p">A real competition where a company wants to automatically measure how similar two patent phrases are. This is exactly the kind of real-world NLP task you'll encounter in industry.</p>

    <div class="split-boxes mt-24" style="flex-direction:column; gap:12px">
      <div style="background:var(--soft);border-radius:8px;padding:16px 20px">
        <p><strong style="color:var(--dark)">Anchor phrase:</strong> &nbsp;"table leg"</p>
      </div>
      <div style="background:var(--soft);border-radius:8px;padding:16px 20px">
        <p><strong style="color:var(--dark)">Target phrase:</strong> &nbsp;"supporting member"</p>
      </div>
      <div style="background:var(--soft);border-radius:8px;padding:16px 20px">
        <p><strong style="color:var(--dark)">Context (patent section):</strong> &nbsp;A47B (Furniture)</p>
      </div>
      <div style="background:var(--accent-light);border:2px solid var(--accent);border-radius:8px;padding:16px 20px">
        <p><strong style="color:var(--accent)">Goal ‚Äî predict similarity score:</strong> &nbsp;0 = different, 0.5 = related, 1.0 = identical meaning</p>
      </div>
    </div>
    <div class="slide-num">13 / 40</div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SLIDE 14 -->
  <div class="slide">
    <div class="slide-bar"></div>
    <div class="slide-tag">Today's Task</div>
    <h3>The Data</h3>
    <h2>What's in the Dataset?</h2>
    <table class="data-table mt-8">
      <tr>
        <th>Column</th>
        <th>Example</th>
        <th>Meaning</th>
      </tr>
      <tr><td><strong>anchor</strong></td><td>abatement</td><td>The first phrase to compare</td></tr>
      <tr><td><strong>target</strong></td><td>act of abating</td><td>The second phrase</td></tr>
      <tr><td><strong>context</strong></td><td>A47</td><td>Patent classification section</td></tr>
      <tr><td><strong>score</strong></td><td>0.5</td><td>Human-labelled similarity (0‚Äì1)</td></tr>
    </table>
    <div class="two-col mt-24">
      <div class="callout" style="margin-top:0">
        <p><strong>36,473 rows</strong> ‚Äî but only 733 unique anchor phrases. Many targets paired with the same anchor.</p>
      </div>
      <div class="callout-blue callout" style="margin-top:0">
        <p><strong>106 unique contexts</strong> ‚Äî the same phrase might mean different things in different patent sections.</p>
      </div>
    </div>
    <div class="slide-num">14 / 40</div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SLIDE 15 -->
  <div class="slide">
    <div class="slide-bar"></div>
    <div class="slide-tag">Today's Task</div>
    <h3>Problem Framing</h3>
    <h2>Turning Similarity into Classification</h2>
    <p class="wide-p">BERT is excellent at reading a single input and producing a score. We need to turn our three-column problem (anchor, target, context) into one input string.</p>
    <div class="steps mt-24">
      <div class="step">
        <div class="step-num">1</div>
        <div class="step-content">
          <strong>Concatenate all three fields into one string</strong>
          <span>Add artificial labels so the model can tell fields apart</span>
        </div>
      </div>
    </div>
    <div style="background:var(--soft);border-radius:8px;padding:20px;margin-top:20px;font-family:'JetBrains Mono',monospace;font-size:14px;color:var(--accent);line-height:1.8">
      TEXT1: A47; TEXT2: act of abating; ANC1: abatement
    </div>
    <div class="steps mt-16">
      <div class="step">
        <div class="step-num">2</div>
        <div class="step-content">
          <strong>The model reads this as a standard text classification problem</strong>
          <span>Output: a single number between 0 and 1 representing similarity</span>
        </div>
      </div>
    </div>
    <div class="callout-green callout mt-16">
      <p><strong>This is a common NLP pattern:</strong> Creative problem framing lets you apply a general-purpose model to any specific task.</p>
    </div>
    <div class="slide-num">15 / 40</div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SLIDE 16 -->
  <div class="slide">
    <div class="slide-bar"></div>
    <div class="slide-tag">Today's Task</div>
    <h3>Real-World Applications</h3>
    <h2>Why Text Classification Powers Modern NLP</h2>
    <p>The same pipeline we're building today solves all of these problems.</p>
    <table class="data-table mt-16">
      <tr>
        <th>Application</th>
        <th>Input (the "document")</th>
        <th>Output (the "class")</th>
      </tr>
      <tr><td><strong>Sentiment analysis</strong></td><td>Movie review</td><td>Positive / Negative</td></tr>
      <tr><td><strong>Spam detection</strong></td><td>Email message</td><td>Spam / Not spam</td></tr>
      <tr><td><strong>Email triage</strong></td><td>Customer message</td><td>Sales / Support / Complaint</td></tr>
      <tr><td><strong>Legal discovery</strong></td><td>Legal document</td><td>In-scope / Out-of-scope</td></tr>
      <tr class="highlight"><td><strong>Phrase matching ‚Üê Today</strong></td><td>Anchor + target + context</td><td>Similarity score 0‚Äì1</td></tr>
    </table>
    <div class="slide-num">16 / 40</div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SLIDE 17 -->
  <div class="slide">
    <div class="slide-bar"></div>
    <div class="slide-tag">Building the Pipeline</div>
    <div class="section-label blue">Step 1 of 10</div>
    <h2>Load the Data and Have a Look</h2>
    <p>Always start by exploring your data. Use <strong>pandas</strong> to load the CSV and check what's inside before writing any model code.</p>
    <div class="steps mt-24">
      <div class="step">
        <div class="step-num">1</div>
        <div class="step-content">
          <strong>Load the CSV file</strong>
          <span>pandas read_csv() gives you a table (called a DataFrame) of all 36k rows</span>
        </div>
      </div>
      <div class="step">
        <div class="step-num">2</div>
        <div class="step-content">
          <strong>Look at the first few rows</strong>
          <span>df.head() ‚Äî are the column names what you expect? Do the values make sense?</span>
        </div>
      </div>
      <div class="step">
        <div class="step-num">3</div>
        <div class="step-content">
          <strong>Check for patterns</strong>
          <span>How many unique anchors? Any missing values? What's the score distribution?</span>
        </div>
      </div>
    </div>
    <div class="callout-amber callout mt-16">
      <p><strong>Rule of thumb:</strong> Spend at least as long exploring your data as building your model. Surprises in the data are the most common cause of poor results.</p>
    </div>
    <div class="slide-num">17 / 40</div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SLIDE 18 -->
  <div class="slide">
    <div class="slide-bar"></div>
    <div class="slide-tag">Building the Pipeline</div>
    <div class="section-label blue">Step 2 of 10</div>
    <h2>Build the Input String</h2>
    <p>We combine anchor, target, and context into a single text column so BERT can read the whole thing at once.</p>

    <div style="background:var(--dark);border-radius:8px;padding:24px 28px;margin-top:28px">
      <p style="color:#888;font-size:12px;text-transform:uppercase;letter-spacing:2px;margin-bottom:12px">What we create</p>
      <div style="background:var(--soft);border-radius:6px;padding:16px;font-family:'JetBrains Mono',monospace;font-size:14px;color:var(--accent);line-height:1.8">
        df['input'] = "TEXT1: " + df.context + "; TEXT2: " + df.target + "; ANC1: " + df.anchor
      </div>
    </div>

    <div style="margin-top:24px">
      <p style="font-size:14px;font-weight:700;color:#888;text-transform:uppercase;letter-spacing:1px;margin-bottom:12px">First 3 rows of the new input column</p>
      <div style="background:var(--soft);border-radius:8px;padding:16px 20px;font-family:'JetBrains Mono',monospace;font-size:13px;line-height:2;color:var(--mid)">
        TEXT1: A47; TEXT2: abatement of pollution; ANC1: abatement<br>
        TEXT1: A47; TEXT2: act of abating; ANC1: abatement<br>
        TEXT1: A47; TEXT2: active catalyst; ANC1: abatement
      </div>
    </div>
    <div class="callout mt-16">
      <p>The artificial labels (TEXT1:, TEXT2:, ANC1:) help the model tell the three fields apart without extra code. This is <strong>prompt engineering</strong>.</p>
    </div>
    <div class="slide-num">18 / 40</div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SLIDE 19 -->
  <div class="slide">
    <div class="slide-bar"></div>
    <div class="slide-tag">Building the Pipeline</div>
    <div class="section-label blue">Step 3 of 10</div>
    <h2>Convert to a Hugging Face Dataset</h2>
    <p>Hugging Face has its own Dataset format that's optimised for NLP tasks ‚Äî it's faster and supports efficient batched transformations.</p>
    <div class="two-col mt-24">
      <div class="col-card">
        <h4>pandas DataFrame</h4>
        <ul class="bullets">
          <li>Great for exploration and cleaning</li>
          <li>Loaded entirely into memory</li>
          <li>Use for the early data wrangling steps</li>
        </ul>
      </div>
      <div class="col-card" style="background:var(--accent-light);border:2px solid var(--accent)">
        <h4 style="color:var(--accent)">HF Dataset ‚Üê Switch here</h4>
        <ul class="bullets">
          <li>Memory-mapped ‚Äî handles large files</li>
          <li><strong>Vectorised transforms</strong> ‚Äî tokenise 36k rows in 6 seconds</li>
          <li>Required by the Trainer class</li>
        </ul>
      </div>
    </div>
    <div class="callout-blue callout mt-16">
      <p><strong>One line converts between them:</strong> <span style="font-family:'JetBrains Mono',monospace;font-size:13px">Dataset.from_pandas(df)</span></p>
    </div>
    <div class="slide-num">19 / 40</div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SLIDE 20 -->
  <div class="slide">
    <div class="slide-bar"></div>
    <div class="slide-tag">Building the Pipeline</div>
    <div class="section-label blue">Step 4 of 10</div>
    <h2>Choose a Pretrained Model First</h2>
    <p class="wide-p">This decision must come <em>before</em> tokenisation ‚Äî because the tokeniser must match the vocabulary of the pretrained model you choose.</p>
    <div class="callout mb-8" style="margin-top:24px">
      <p>‚ö†Ô∏è <strong>Common mistake:</strong> Tokenising with the wrong vocabulary. Always load the tokeniser that belongs to your chosen checkpoint.</p>
    </div>
    <div class="steps mt-16">
      <div class="step">
        <div class="step-num">1</div>
        <div class="step-content">
          <strong>Search Hugging Face Hub</strong>
          <span>There are ~44,000 pretrained checkpoints. Search "patent" for domain-specific models.</span>
        </div>
      </div>
      <div class="step">
        <div class="step-num">2</div>
        <div class="step-content">
          <strong>Good general-purpose default for this task</strong>
          <span style="font-family:'JetBrains Mono',monospace;font-size:13px;color:var(--accent)">microsoft/deberta-v3-small</span>
        </div>
      </div>
      <div class="step">
        <div class="step-num">3</div>
        <div class="step-content">
          <strong>For production: search for domain-specific models</strong>
          <span>A model pretrained on patent text will outperform a general one</span>
        </div>
      </div>
    </div>
    <div class="slide-num">20 / 40</div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SLIDE 21 -->
  <div class="slide">
    <div class="slide-bar"></div>
    <div class="slide-tag">Building the Pipeline</div>
    <div class="section-label blue">Step 5 of 10</div>
    <h2>Load the Matching Tokeniser</h2>
    <p class="wide-p"><strong>AutoTokenizer</strong> is Hugging Face's smart loader ‚Äî you give it the checkpoint name and it downloads the correct vocabulary and tokenisation rules automatically.</p>

    <div style="background:var(--dark);border-radius:8px;padding:24px 28px;margin-top:28px">
      <p style="color:#888;font-size:12px;text-transform:uppercase;letter-spacing:2px;margin-bottom:12px">Loading the tokeniser</p>
      <div style="background:#1e2a3a;border-radius:6px;padding:16px;font-family:'JetBrains Mono',monospace;font-size:14px;line-height:1.8;color:#e0e0e0">
        <span style="color:#f8a">from</span> transformers <span style="color:#f8a">import</span> AutoTokenizer<br><br>
        tok = AutoTokenizer.from_pretrained(<br>
        &nbsp;&nbsp;&nbsp;&nbsp;"microsoft/deberta-v3-small"<br>
        )
      </div>
    </div>

    <div class="callout-green callout mt-24">
      <p>This downloads the vocabulary + rules used when the original model was pretrained. Using a different tokeniser would be like giving the model a text in a different alphabet.</p>
    </div>
    <div class="slide-num">21 / 40</div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SLIDE 22 -->
  <div class="slide">
    <div class="slide-bar"></div>
    <div class="slide-tag">Building the Pipeline</div>
    <div class="section-label blue">Step 6 of 10</div>
    <h2>Tokenise the Whole Dataset</h2>
    <p>We apply our tokeniser to every row using <strong>.map()</strong> ‚Äî Hugging Face's vectorised transform that processes all 36k rows in ~6 seconds.</p>

    <div style="background:var(--soft);border-radius:8px;padding:20px 24px;margin-top:24px">
      <p style="font-size:15px;font-weight:700;color:var(--dark);margin-bottom:12px">What the tok_func does to each row:</p>
      <ul class="bullets">
        <li>Takes the <strong>input string</strong> we built in Step 2</li>
        <li>Splits it into tokens, looks up each ID in the vocabulary</li>
        <li><strong>Pads</strong> short sequences to length 128 with a [PAD] token</li>
        <li><strong>Truncates</strong> long sequences at 128 tokens</li>
        <li>Returns <strong>input_ids</strong> and <strong>attention_mask</strong></li>
      </ul>
    </div>

    <div class="callout-blue callout mt-16">
      <p><strong>attention_mask:</strong> A list of 1s and 0s telling the model which tokens are real words (1) and which are padding (0). Padding tokens should be ignored during learning.</p>
    </div>
    <div class="slide-num">22 / 40</div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SLIDE 23 -->
  <div class="slide">
    <div class="slide-bar"></div>
    <div class="slide-tag">Building the Pipeline</div>
    <h3>Tokenised Row</h3>
    <h2>What One Tokenised Example Looks Like</h2>
    <p>Let's inspect row 0 after tokenisation to see exactly what the model receives.</p>

    <div style="margin-top:24px">
      <p style="font-size:13px;font-weight:700;color:#888;text-transform:uppercase;letter-spacing:1px;margin-bottom:8px">Original text</p>
      <div style="background:var(--soft);border-radius:6px;padding:14px 18px;font-family:'JetBrains Mono',monospace;font-size:14px;color:var(--mid)">
        'TEXT1: A47; TEXT2: abatement of pollution; ANC1: abatement'
      </div>
    </div>

    <div style="margin-top:16px">
      <p style="font-size:13px;font-weight:700;color:#888;text-transform:uppercase;letter-spacing:1px;margin-bottom:8px">input_ids (first 8 of 128)</p>
      <div class="token-row">
        <div class="token id">1</div>
        <div class="token id">54453</div>
        <div class="token id">435</div>
        <div class="token id">294</div>
        <div class="token id">336</div>
        <div class="token id">5753</div>
        <div class="token id">346</div>
        <div class="token id">54453</div>
        <div class="token special">‚Ä¶128 total</div>
      </div>
    </div>

    <div class="callout-blue callout mt-24">
      <p>Token ID <strong>1</strong> = [CLS] (start of sequence). Token <strong>2</strong> = [SEP] (separator). These special tokens help BERT know where the input begins and ends.</p>
    </div>
    <div class="slide-num">23 / 40</div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SLIDE 24 -->
  <div class="slide">
    <div class="slide-bar"></div>
    <div class="slide-tag">Building the Pipeline</div>
    <div class="section-label blue">Step 7 of 10</div>
    <h2>Set Up the Labels</h2>
    <p class="wide-p">Hugging Face's Trainer expects the target column to be literally named <strong>"labels"</strong>. Our column is named "score" ‚Äî so we rename it.</p>

    <div style="background:var(--soft);border-radius:8px;padding:20px 24px;margin-top:28px">
      <p style="font-size:15px;color:var(--mid);line-height:1.6">
        The <strong style="color:var(--dark)">score</strong> column contains values like 0, 0.25, 0.5, 0.75, 1.0<br>
        After renaming it becomes the <strong style="color:var(--dark)">labels</strong> column<br>
        The Trainer reads labels automatically and uses them to compute loss
      </p>
    </div>

    <div class="callout-green callout mt-24">
      <p><strong>Binary / multi-class / regression</strong> all use the same "labels" key. The model's output size (num_labels) determines whether it's treated as classification or regression.</p>
    </div>
    <div class="callout-amber callout mt-16">
      <p>Since our scores are continuous (0.0 to 1.0), this is a <strong>regression</strong> problem. We set num_labels=1 when building the model.</p>
    </div>
    <div class="slide-num">24 / 40</div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SLIDE 25 -->
  <div class="slide">
    <div class="slide-bar"></div>
    <div class="interlude">
      <div class="icon">‚è∏</div>
      <div>
        <strong>Conceptual Interlude</strong>
        <p>Before we run any training, we need to understand how to measure whether our model is actually learning ‚Äî or just memorising.</p>
      </div>
    </div>
    <h2>Why We Need a Validation Set</h2>
    <p class="wide-p">If you only measure performance on the data the model trained on, you'll always see improvement ‚Äî even if the model is useless on new data.</p>
    <div class="callout mt-24">
      <p><strong>The core problem:</strong> Training loss <em>always</em> goes down. But that doesn't mean the model is learning anything generalizable. It might just be memorising the training data.</p>
    </div>
    <div class="callout-blue callout mt-16">
      <p><strong>Solution:</strong> Hold back a portion of data that the model <em>never sees during training</em>. Measure performance on this validation set to detect overfitting early.</p>
    </div>
    <div class="slide-num">25 / 40</div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SLIDE 26 -->
  <div class="slide">
    <div class="slide-bar"></div>
    <div class="slide-tag">Validation Theory</div>
    <h3>Overfitting vs Underfitting</h3>
    <h2>The Goldilocks Problem</h2>
    <p>A model can fail in two opposite directions. You need it "just right".</p>

    <div style="margin-top:28px">
      <svg viewBox="0 0 820 200" xmlns="http://www.w3.org/2000/svg" style="width:100%;max-width:820px">
        <!-- Under-fit -->
        <rect x="0" y="20" width="240" height="160" rx="8" fill="#fff" stroke="#e0e0e8" stroke-width="2"/>
        <text x="120" y="45" text-anchor="middle" font-family="Source Sans 3" font-size="13" font-weight="700" fill="#888">UNDERFITTING</text>
        <!-- Simple line through scattered points -->
        <circle cx="40" cy="150" r="4" fill="#C8102E"/><circle cx="65" cy="100" r="4" fill="#C8102E"/>
        <circle cx="90" cy="80" r="4" fill="#C8102E"/><circle cx="115" cy="60" r="4" fill="#C8102E"/>
        <circle cx="140" cy="90" r="4" fill="#C8102E"/><circle cx="165" cy="50" r="4" fill="#C8102E"/>
        <circle cx="200" cy="130" r="4" fill="#C8102E"/>
        <line x1="30" y1="150" x2="210" y2="60" stroke="#2d6a9f" stroke-width="2.5"/>
        <text x="120" y="185" text-anchor="middle" font-family="Source Sans 3" font-size="12" fill="#888">Too simple ‚Äî misses pattern</text>

        <!-- Just right -->
        <rect x="280" y="20" width="240" height="160" rx="8" fill="#e8f7ef" stroke="#1a7a4a" stroke-width="2"/>
        <text x="400" y="45" text-anchor="middle" font-family="Source Sans 3" font-size="13" font-weight="700" fill="#1a7a4a">JUST RIGHT ‚úì</text>
        <circle cx="310" cy="150" r="4" fill="#C8102E"/><circle cx="335" cy="100" r="4" fill="#C8102E"/>
        <circle cx="360" cy="80" r="4" fill="#C8102E"/><circle cx="385" cy="60" r="4" fill="#C8102E"/>
        <circle cx="410" cy="90" r="4" fill="#C8102E"/><circle cx="435" cy="50" r="4" fill="#C8102E"/>
        <circle cx="470" cy="130" r="4" fill="#C8102E"/>
        <path d="M305 145 Q350 70 400 70 Q450 70 475 135" stroke="#1a7a4a" stroke-width="2.5" fill="none"/>
        <text x="400" y="185" text-anchor="middle" font-family="Source Sans 3" font-size="12" fill="#1a7a4a">Good generalisation</text>

        <!-- Over-fit -->
        <rect x="560" y="20" width="240" height="160" rx="8" fill="#fff" stroke="#e0e0e8" stroke-width="2"/>
        <text x="680" y="45" text-anchor="middle" font-family="Source Sans 3" font-size="13" font-weight="700" fill="#888">OVERFITTING</text>
        <circle cx="590" cy="150" r="4" fill="#C8102E"/><circle cx="615" cy="100" r="4" fill="#C8102E"/>
        <circle cx="640" cy="80" r="4" fill="#C8102E"/><circle cx="665" cy="60" r="4" fill="#C8102E"/>
        <circle cx="690" cy="90" r="4" fill="#C8102E"/><circle cx="715" cy="50" r="4" fill="#C8102E"/>
        <circle cx="750" cy="130" r="4" fill="#C8102E"/>
        <path d="M585 148 Q595 105 615 100 Q625 80 640 80 Q652 60 665 60 Q680 90 690 90 Q700 50 715 50 Q730 90 745 130" stroke="#C8102E" stroke-width="2.5" fill="none"/>
        <text x="680" y="185" text-anchor="middle" font-family="Source Sans 3" font-size="12" fill="#888">Memorised training data</text>
      </svg>
    </div>
    <div class="slide-num">26 / 40</div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SLIDE 27 -->
  <div class="slide">
    <div class="slide-bar"></div>
    <div class="slide-tag">Validation Theory</div>
    <h3>Data Splits</h3>
    <h2>Three Splits, Three Roles</h2>
    <div class="split-boxes mt-16">
      <div class="split-box sb-train">
        <h4>Training Set (~75%)</h4>
        <p>Model weights are updated using this data. The model <strong>learns</strong> here.</p>
      </div>
      <div class="split-box sb-val">
        <h4>Validation Set (~25%)</h4>
        <p>Checked after each epoch to detect overfitting. Guides <strong>hyperparameter tuning</strong>.</p>
      </div>
      <div class="split-box sb-test">
        <h4>Test Set (Locked)</h4>
        <p>Opened <strong>once</strong> at the end to report final performance. Never used during development.</p>
      </div>
    </div>
    <div class="callout mt-24">
      <p><strong>On Kaggle:</strong> The test set is the competition data. The private leaderboard is only revealed after the competition closes ‚Äî enforcing honest evaluation.</p>
    </div>
    <div class="callout-amber callout mt-12">
      <p><strong>A good model shows:</strong> training loss ‚Üì and validation loss ‚Üì together. Danger sign: training loss keeps falling while validation loss starts rising.</p>
    </div>
    <div class="slide-num">27 / 40</div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SLIDE 28 -->
  <div class="slide">
    <div class="slide-bar"></div>
    <div class="slide-tag">Validation Theory</div>
    <h3>Splitting Strategy</h3>
    <h2>Not All Splits Are Equal</h2>
    <p>A random split is fine for most tasks ‚Äî but some datasets need more care.</p>
    <table class="data-table mt-16">
      <tr>
        <th>Dataset type</th>
        <th>‚ùå Bad split</th>
        <th>‚úì Good split</th>
      </tr>
      <tr>
        <td><strong>Time-series (sales)</strong></td>
        <td>Random rows ‚Üí future leaks into training</td>
        <td>Last N weeks as validation</td>
      </tr>
      <tr>
        <td><strong>Face recognition</strong></td>
        <td>Random photos ‚Üí same person in train & val</td>
        <td>Group by person ID</td>
      </tr>
      <tr>
        <td><strong>Recommender systems</strong></td>
        <td>Random rows ‚Üí same user in both sets</td>
        <td>Group by user ID</td>
      </tr>
      <tr class="highlight">
        <td><strong>Patent phrases ‚Üê Us</strong></td>
        <td>‚Äî</td>
        <td>Random OK, but check anchor duplicates</td>
      </tr>
    </table>
    <div class="callout-green callout mt-16">
      <p><strong>Rule:</strong> Ask "what would the model see in the real world that it never saw during training?" Design your split to simulate that.</p>
    </div>
    <div class="slide-num">28 / 40</div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SLIDE 29 -->
  <div class="slide">
    <div class="slide-bar"></div>
    <div class="slide-tag">Validation Theory</div>
    <h3>Cross-validation</h3>
    <h2>Cross-validation vs a Fixed Hold-out Set</h2>
    <div class="two-col mt-16">
      <div class="col-card">
        <h4>k-fold cross-validation</h4>
        <ul class="bullets">
          <li>Split data into k equal parts</li>
          <li>Train k times, each with a different fold as validation</li>
          <li>Average the k scores for a stable estimate</li>
          <li><strong>Use for:</strong> comparing models / benchmarking</li>
          <li><strong>Downside:</strong> k√ó slower</li>
        </ul>
      </div>
      <div class="col-card" style="background:var(--red-light);border:2px solid var(--red)">
        <h4 style="color:var(--red)">Fixed hold-out set ‚Üê What we use</h4>
        <ul class="bullets">
          <li>Split once, keep the same val set throughout</li>
          <li>Tune hyperparameters against it</li>
          <li><strong>Use for:</strong> iterative development and competitions</li>
          <li><strong>Downside:</strong> risk of overfitting to the specific split</li>
        </ul>
      </div>
    </div>
    <div class="callout-amber callout mt-16">
      <p>‚ö†Ô∏è <strong>If you tune too many hyperparameters against the same validation set</strong>, you will slowly overfit to it. This is "leakage through hyperparameter search".</p>
    </div>
    <div class="slide-num">29 / 40</div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SLIDE 30 -->
  <div class="slide">
    <div class="slide-bar"></div>
    <div class="slide-tag">Metrics</div>
    <h3>Two Different Things</h3>
    <h2>Metric vs Loss ‚Äî Don't Confuse Them</h2>
    <div class="compare-grid mt-16">
      <div class="compare-card">
        <h4>Loss function</h4>
        <ul class="bullets">
          <li>Used internally during training to compute gradients</li>
          <li>Must be smooth and differentiable</li>
          <li>Examples: MSE, MAE, Cross-entropy</li>
          <li>Optimiser minimises this every step</li>
        </ul>
      </div>
      <div class="compare-card active-card">
        <h4>Metric</h4>
        <ul class="bullets">
          <li>What stakeholders actually care about</li>
          <li>Can be non-smooth or non-differentiable</li>
          <li>Examples: Accuracy, F1 score, Pearson r</li>
          <li>You report this on validation and test sets</li>
        </ul>
      </div>
    </div>
    <div class="callout mt-24">
      <p>‚ö†Ô∏è <strong>A model can lower its loss every epoch while the metric stays flat.</strong> Always track and report the metric ‚Äî not just the loss ‚Äî when evaluating progress.</p>
    </div>
    <div class="slide-num">30 / 40</div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SLIDE 31 -->
  <div class="slide">
    <div class="slide-bar"></div>
    <div class="slide-tag">Metrics</div>
    <h3>Our Competition Metric</h3>
    <h2>Pearson Correlation Coefficient (r)</h2>
    <p class="wide-p">Kaggle measures our model using Pearson r ‚Äî a number between ‚àí1 and +1 that measures how well our predicted scores <em>move in the same direction</em> as the true scores.</p>
    <table class="data-table mt-16">
      <tr><th>r value</th><th>What it looks like in a scatter plot</th></tr>
      <tr><td><strong>+1.0</strong></td><td>Perfect ‚Äî predictions match truth exactly</td></tr>
      <tr><td><strong>+0.68</strong></td><td>Good ‚Äî clear upward trend visible</td></tr>
      <tr><td><strong>+0.43</strong></td><td>Moderate ‚Äî cloud with slight slope</td></tr>
      <tr><td><strong>+0.20</strong></td><td>Weak ‚Äî slope barely visible</td></tr>
      <tr><td><strong>0.0</strong></td><td>None ‚Äî predictions are random relative to truth</td></tr>
    </table>
    <div class="callout-blue callout mt-16">
      <p>Pearson r measures <strong>linear correlation</strong>. It doesn't care about the absolute scale of predictions ‚Äî only whether high predictions correspond to high truth values.</p>
    </div>
    <div class="slide-num">31 / 40</div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SLIDE 32 -->
  <div class="slide">
    <div class="slide-bar"></div>
    <div class="slide-tag">Metrics</div>
    <h3>Worked Example</h3>
    <h2>Calculating Pearson r by Hand</h2>
    <p>Let's see what r looks like with 5 prediction/truth pairs, and what happens when we add an outlier.</p>
    <table class="pearson-table">
      <tr>
        <th>Pair</th>
        <th>True score</th>
        <th>Predicted</th>
        <th>Difference</th>
      </tr>
      <tr><td>1</td><td>0.25</td><td>0.30</td><td>+0.05 ‚úì</td></tr>
      <tr><td>2</td><td>0.50</td><td>0.45</td><td>‚àí0.05 ‚úì</td></tr>
      <tr><td>3</td><td>0.75</td><td>0.80</td><td>+0.05 ‚úì</td></tr>
      <tr><td>4</td><td>1.00</td><td>0.95</td><td>‚àí0.05 ‚úì</td></tr>
      <tr><td>5</td><td>0.00</td><td>0.05</td><td>+0.05 ‚úì</td></tr>
      <tr class="outlier"><td>+Outlier</td><td>0.50</td><td>0.00</td><td>‚àí0.50 ‚úó‚úó‚úó</td></tr>
    </table>
    <div class="two-col mt-16">
      <div class="callout-green callout" style="margin:0">
        <p>Without outlier: <strong>r = 0.999</strong> ‚Äî near perfect</p>
      </div>
      <div class="callout" style="margin:0">
        <p>With outlier: <strong>r = 0.43</strong> ‚Äî one bad prediction drags r down dramatically</p>
      </div>
    </div>
    <div class="slide-num">32 / 40</div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SLIDE 33 -->
  <div class="slide">
    <div class="slide-bar"></div>
    <div class="slide-tag">Metrics</div>
    <h3>Practical Implication</h3>
    <h2>Outliers Can Wreck Your Kaggle Score</h2>
    <p class="wide-p">Because Pearson r is sensitive to large errors on individual rows, you need to make sure no single prediction is wildly wrong.</p>
    <div class="steps mt-24">
      <div class="step">
        <div class="step-num">1</div>
        <div class="step-content">
          <strong>After training: inspect the raw model outputs</strong>
          <span>BERT's output head has no bounds ‚Äî it can produce values outside [0, 1]</span>
        </div>
      </div>
      <div class="step">
        <div class="step-num">2</div>
        <div class="step-content">
          <strong>Clip predictions to the valid range</strong>
          <span>Force all predictions to stay between 0.0 and 1.0</span>
        </div>
      </div>
      <div class="step">
        <div class="step-num">3</div>
        <div class="step-content">
          <strong>This simple step immediately boosts your leaderboard score</strong>
          <span>Without clipping, a few extreme values can destroy your Pearson r</span>
        </div>
      </div>
    </div>
    <div class="callout mt-16">
      <p>üìå <strong>Lesson:</strong> When Pearson r is your metric, eliminating large errors on any single row is more important than improving average accuracy.</p>
    </div>
    <div class="slide-num">33 / 40</div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SLIDE 34 -->
  <div class="slide">
    <div class="slide-bar"></div>
    <div class="slide-tag">Building the Pipeline</div>
    <div class="section-label blue">Step 8 of 10</div>
    <h2>Configure the Training Settings</h2>
    <p><strong>TrainingArguments</strong> is a config object ‚Äî it holds all your training hyperparameters in one place. Think of it as the equivalent of fastai's fit_one_cycle() options.</p>
    <table class="data-table mt-16">
      <tr><th>Setting</th><th>What it does</th><th>Our value</th></tr>
      <tr><td><strong>learning_rate</strong></td><td>How big each gradient step is</td><td>8e-5</td></tr>
      <tr><td><strong>num_train_epochs</strong></td><td>How many times to go through all training data</td><td>4</td></tr>
      <tr><td><strong>warmup_ratio</strong></td><td>Fraction of steps to ramp LR up slowly at start</td><td>0.1</td></tr>
      <tr><td><strong>lr_scheduler_type</strong></td><td>How LR changes over training (cosine = smooth decay)</td><td>cosine</td></tr>
      <tr><td><strong>weight_decay</strong></td><td>Regularisation ‚Äî prevents individual weights getting too large</td><td>0.01</td></tr>
      <tr><td><strong>evaluation_strategy</strong></td><td>When to check validation performance</td><td>per epoch</td></tr>
    </table>
    <div class="slide-num">34 / 40</div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SLIDE 35 -->
  <div class="slide">
    <div class="slide-bar"></div>
    <div class="slide-tag">Building the Pipeline</div>
    <div class="section-label blue">Step 9 of 10</div>
    <h2>Build the Model Object</h2>
    <p class="wide-p">We load the pretrained model and attach a new randomly-initialised output head sized to our task (1 output = 1 similarity score).</p>
    <div style="margin-top:24px">
      <svg viewBox="0 0 700 130" xmlns="http://www.w3.org/2000/svg" style="width:100%;max-width:700px">
        <rect x="0" y="30" width="380" height="70" rx="6" fill="#1a1a2e"/>
        <text x="190" y="60" text-anchor="middle" fill="white" font-family="Source Sans 3" font-size="14" font-weight="700">Pretrained DeBERTa-v3-small</text>
        <text x="190" y="80" text-anchor="middle" fill="#aaa" font-family="Source Sans 3" font-size="12">Weights already trained on 100GB+ of text</text>
        <path d="M380 65 L430 65" stroke="#ccc" stroke-width="2" marker-end="url(#arr2)"/>
        <defs><marker id="arr2" markerWidth="8" markerHeight="8" refX="6" refY="3" orient="auto"><path d="M0,0 L0,6 L8,3 z" fill="#ccc"/></marker></defs>
        <rect x="430" y="30" width="270" height="70" rx="6" fill="#C8102E"/>
        <text x="565" y="60" text-anchor="middle" fill="white" font-family="Source Sans 3" font-size="14" font-weight="700">+ New Linear Head</text>
        <text x="565" y="80" text-anchor="middle" fill="#ffaaaa" font-family="Source Sans 3" font-size="12">768 inputs ‚Üí 1 output (random init)</text>
      </svg>
    </div>
    <div class="two-col mt-20">
      <div class="callout" style="margin:0">
        <p>The pretrained layers hold valuable knowledge. We <strong>keep them</strong> and update them slowly.</p>
      </div>
      <div class="callout callout-blue" style="margin:0">
        <p>The new head starts random and must <strong>learn quickly</strong> from task-specific data.</p>
      </div>
    </div>
    <div class="callout-green callout mt-12">
      <p><strong>AutoModelForSequenceClassification</strong> handles all of this automatically ‚Äî just pass the checkpoint name and num_labels=1.</p>
    </div>
    <div class="slide-num">35 / 40</div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SLIDE 36 -->
  <div class="slide">
    <div class="slide-bar"></div>
    <div class="slide-tag">Building the Pipeline</div>
    <div class="section-label blue">Step 10 of 10</div>
    <h2>Create the Trainer</h2>
    <p>The Trainer is the Hugging Face equivalent of fastai's Learner. It bundles everything together so training is one function call.</p>

    <div style="background:var(--soft);border-radius:8px;padding:20px 24px;margin-top:24px">
      <p style="font-weight:700;color:var(--dark);margin-bottom:14px">The Trainer needs:</p>
      <ul class="bullets">
        <li><strong>model</strong> ‚Äî the DeBERTa model with classification head</li>
        <li><strong>args</strong> ‚Äî the TrainingArguments config from Step 8</li>
        <li><strong>train_dataset</strong> ‚Äî tokenised training rows</li>
        <li><strong>eval_dataset</strong> ‚Äî tokenised validation rows</li>
        <li><strong>compute_metrics</strong> ‚Äî our Pearson r function</li>
        <li><strong>data_collator</strong> ‚Äî handles dynamic padding for each batch</li>
      </ul>
    </div>
    <div class="callout-blue callout mt-16">
      <p>Once created, training starts with <strong>trainer.train()</strong>. That's it. The Trainer handles batching, GPU transfer, gradient accumulation, logging, and checkpointing.</p>
    </div>
    <div class="slide-num">36 / 40</div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SLIDE 37 -->
  <div class="slide">
    <div class="slide-bar"></div>
    <div class="slide-tag">Results</div>
    <h3>Training Snapshot</h3>
    <h2>Running the Training Loop</h2>
    <p>One epoch through 27,000 training rows takes about <strong>5 minutes</strong> on a free Kaggle GPU. After training, you see a live log like this:</p>

    <div style="background:var(--dark);border-radius:8px;padding:20px 24px;margin-top:24px;font-family:'JetBrains Mono',monospace;font-size:13px;line-height:2;color:#ccc">
      <span style="color:#888">Epoch 1/4</span><br>
      train_loss: 0.241 &nbsp;| &nbsp;eval_loss: 0.198 &nbsp;| &nbsp;<span style="color:#4ade80">pearson_r: 0.783</span><br>
      <span style="color:#888">Epoch 2/4</span><br>
      train_loss: 0.187 &nbsp;| &nbsp;eval_loss: 0.164 &nbsp;| &nbsp;<span style="color:#4ade80">pearson_r: 0.821</span><br>
      <span style="color:#888">Epoch 3/4</span><br>
      train_loss: 0.152 &nbsp;| &nbsp;eval_loss: 0.148 &nbsp;| &nbsp;<span style="color:#4ade80">pearson_r: 0.834</span>
    </div>

    <div class="callout-green callout mt-20">
      <p>üìà Both training loss and validation loss are decreasing together ‚Äî the model is generalising, not overfitting. This is exactly what we want to see.</p>
    </div>
    <div class="slide-num">37 / 40</div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SLIDE 38 -->
  <div class="slide">
    <div class="slide-bar"></div>
    <div class="slide-tag">Results</div>
    <h3>After 1 Epoch</h3>
    <h2>r = 0.834 ‚Äî Why Does It Work So Fast?</h2>
    <div class="big-stat">
      <span class="num">0.834</span>
      <span class="label">Pearson r on validation set after just 1 epoch of fine-tuning</span>
    </div>
    <p class="wide-p">This result is remarkable. We trained for less than 5 minutes and achieved strong performance. The reason is transfer learning.</p>
    <div class="steps mt-16">
      <div class="step">
        <div class="step-num">1</div>
        <div class="step-content">
          <strong>DeBERTa already knows English</strong>
          <span>Pretraining on billions of sentences gives the model rich semantic knowledge</span>
        </div>
      </div>
      <div class="step">
        <div class="step-num">2</div>
        <div class="step-content">
          <strong>Fine-tuning only needs small adjustments</strong>
          <span>The model barely needs to change ‚Äî it already understands meaning and similarity</span>
        </div>
      </div>
      <div class="step">
        <div class="step-num">3</div>
        <div class="step-content">
          <strong>This is the power of pretraining + fine-tuning</strong>
          <span>Billions of dollars of compute, distilled into a free downloadable checkpoint</span>
        </div>
      </div>
    </div>
    <div class="slide-num">38 / 40</div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SLIDE 39 -->
  <div class="slide">
    <div class="slide-bar"></div>
    <div class="slide-tag">Results</div>
    <h3>Submission</h3>
    <h2>Post-processing Predictions and Submitting</h2>
    <div class="steps mt-16">
      <div class="step">
        <div class="step-num">1</div>
        <div class="step-content">
          <strong>Run predictions on the test set</strong>
          <span>trainer.predict() returns raw float scores ‚Äî these can go outside [0, 1]</span>
        </div>
      </div>
      <div class="step">
        <div class="step-num">2</div>
        <div class="step-content">
          <strong>Always inspect outputs before submitting</strong>
          <span>Are any values negative? Greater than 1? This is a sign something went wrong.</span>
        </div>
      </div>
      <div class="step">
        <div class="step-num">3</div>
        <div class="step-content">
          <strong>Clip to [0, 1] with torch.clamp()</strong>
          <span>This simple step immediately improves your correlation score on the leaderboard</span>
        </div>
      </div>
      <div class="step">
        <div class="step-num">4</div>
        <div class="step-content">
          <strong>Save to CSV and upload to Kaggle</strong>
          <span>The submission file needs two columns: text_id and score</span>
        </div>
      </div>
    </div>
    <div class="slide-num">39 / 40</div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SLIDE 40 -->
  <div class="slide">
    <div class="slide-bar"></div>
    <div class="slide-tag">Ethics</div>
    <h3>SLO4 ‚Äî Responsible AI</h3>
    <h2>Ethics Check: NLP Models</h2>
    <p>Before deploying any NLP model, you must ask these questions about your data and use case.</p>
    <div class="two-col mt-20">
      <div>
        <p style="font-size:13px;font-weight:700;text-transform:uppercase;letter-spacing:1px;color:#888;margin-bottom:10px">Potential misuse risks</p>
        <div class="ethics-pills">
          <div class="ethics-pill risk">Plagiarism detection systems</div>
          <div class="ethics-pill risk">Surveillance of communications</div>
          <div class="ethics-pill risk">IP theft / competitive intelligence</div>
          <div class="ethics-pill risk">Automated rejection without explanation</div>
        </div>
      </div>
      <div>
        <p style="font-size:13px;font-weight:700;text-transform:uppercase;letter-spacing:1px;color:#888;margin-bottom:10px">Required practices</p>
        <div class="ethics-pills">
          <div class="ethics-pill ok">Document data provenance</div>
          <div class="ethics-pill ok">Record model limitations</div>
          <div class="ethics-pill ok">Declare intended use</div>
          <div class="ethics-pill ok">Test for domain bias</div>
        </div>
      </div>
    </div>
    <div class="callout-amber callout mt-20">
      <p><strong>Patent data question:</strong> Who owns the text in a patent corpus? Training on publicly-filed patents is generally allowed, but check jurisdiction-specific rules before deploying commercially.</p>
    </div>
    <div class="callout-blue callout mt-12">
      <p><strong>Model card:</strong> When you submit your project, document what your model can and cannot do, where it might fail, and how it should ‚Äî and shouldn't ‚Äî be used.</p>
    </div>
    <div class="slide-num">40 / 40</div>
  </div>

</div><!-- /.deck -->

<!-- ‚îÄ‚îÄ CONTROLS ‚îÄ‚îÄ -->
<div class="controls">
  <button class="btn" id="prevBtn" onclick="changeSlide(-1)" disabled>‚Üê Previous</button>
  <div class="progress-bar"><div class="progress-fill" id="progressFill" style="width:2.5%"></div></div>
  <span class="progress-text" id="progressText">1 / 40</span>
  <button class="btn primary" id="nextBtn" onclick="changeSlide(1)">Next ‚Üí</button>
</div>

<script>
  let current = 0;
  const slides = document.querySelectorAll('.slide');
  const total = slides.length;

  function changeSlide(dir) {
    slides[current].classList.remove('active');
    current = Math.max(0, Math.min(total - 1, current + dir));
    slides[current].classList.add('active');
    document.getElementById('prevBtn').disabled = current === 0;
    document.getElementById('nextBtn').disabled = current === total - 1;
    document.getElementById('progressText').textContent = `${current + 1} / ${total}`;
    document.getElementById('progressFill').style.width = `${((current + 1) / total) * 100}%`;
    window.scrollTo({ top: 0, behavior: 'smooth' });
  }

  document.addEventListener('keydown', e => {
    if (e.key === 'ArrowRight' || e.key === 'ArrowDown') changeSlide(1);
    if (e.key === 'ArrowLeft'  || e.key === 'ArrowUp')   changeSlide(-1);
  });
</script>
</body>
</html>