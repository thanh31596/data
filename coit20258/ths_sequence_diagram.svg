<svg width="1000" height="700" xmlns="http://www.w3.org/2000/svg">
  <!-- Title -->
  <text x="500" y="30" text-anchor="middle" font-family="Arial" font-size="18" font-weight="bold">Book Consultation - Sequence Diagram</text>
  
  <!-- Actors/Objects -->
  <rect x="50" y="60" width="80" height="30" fill="#E6F3FF" stroke="#0066CC" stroke-width="2"/>
  <text x="90" y="80" text-anchor="middle" font-family="Arial" font-size="12" font-weight="bold">Patient</text>
  
  <rect x="180" y="60" width="100" height="30" fill="#E6FFE6" stroke="#009900" stroke-width="2"/>
  <text x="230" y="80" text-anchor="middle" font-family="Arial" font-size="12" font-weight="bold">BookingView</text>
  
  <rect x="330" y="60" width="120" height="30" fill="#FFE6E6" stroke="#CC0000" stroke-width="2"/>
  <text x="390" y="80" text-anchor="middle" font-family="Arial" font-size="12" font-weight="bold">BookingController</text>
  
  <rect x="500" y="60" width="100" height="30" fill="#FFFFCC" stroke="#CCCC00" stroke-width="2"/>
  <text x="550" y="80" text-anchor="middle" font-family="Arial" font-size="12" font-weight="bold">Patient Model</text>
  
  <rect x="650" y="60" width="100" height="30" fill="#F0E6FF" stroke="#6600CC" stroke-width="2"/>
  <text x="700" y="80" text-anchor="middle" font-family="Arial" font-size="12" font-weight="bold">Specialist Model</text>
  
  <rect x="800" y="60" width="120" height="30" fill="#E6F0FF" stroke="#0080FF" stroke-width="2"/>
  <text x="860" y="80" text-anchor="middle" font-family="Arial" font-size="12" font-weight="bold">Consultation Model</text>
  
  <!-- Lifelines -->
  <line x1="90" y1="90" x2="90" y2="650" stroke="#000000" stroke-width="2" stroke-dasharray="5,5"/>
  <line x1="230" y1="90" x2="230" y2="650" stroke="#000000" stroke-width="2" stroke-dasharray="5,5"/>
  <line x1="390" y1="90" x2="390" y2="650" stroke="#000000" stroke-width="2" stroke-dasharray="5,5"/>
  <line x1="550" y1="90" x2="550" y2="650" stroke="#000000" stroke-width="2" stroke-dasharray="5,5"/>
  <line x1="700" y1="90" x2="700" y2="650" stroke="#000000" stroke-width="2" stroke-dasharray="5,5"/>
  <line x1="860" y1="90" x2="860" y2="650" stroke="#000000" stroke-width="2" stroke-dasharray="5,5"/>
  
  <!-- Activation boxes -->
  <rect x="85" y="120" width="10" height="500" fill="#E6F3FF" stroke="#0066CC" stroke-width="1"/>
  <rect x="225" y="140" width="10" height="460" fill="#E6FFE6" stroke="#009900" stroke-width="1"/>
  <rect x="385" y="160" width="10" height="420" fill="#FFE6E6" stroke="#CC0000" stroke-width="1"/>
  <rect x="545" y="200" width="10" height="100" fill="#FFFFCC" stroke="#CCCC00" stroke-width="1"/>
  <rect x="695" y="320" width="10" height="100" fill="#F0E6FF" stroke="#6600CC" stroke-width="1"/>
  <rect x="855" y="480" width="10" height="100" fill="#E6F0FF" stroke="#0080FF" stroke-width="1"/>
  
  <!-- Messages -->
  <!-- 1. Patient clicks "Book Consultation" -->
  <line x1="95" y1="130" x2="225" y2="130" stroke="#000000" stroke-width="1" marker-end="url(#arrowhead)"/>
  <text x="160" y="125" font-family="Arial" font-size="10">1: clickBookConsultation()</text>
  
  <!-- 2. BookingView displays booking form -->
  <line x1="230" y1="150" x2="95" y2="150" stroke="#000000" stroke-width="1" marker-end="url(#arrowhead)"/>
  <text x="120" y="145" font-family="Arial" font-size="10">2: displayBookingForm()</text>
  
  <!-- 3. Patient fills and submits form -->
  <line x1="95" y1="170" x2="225" y2="170" stroke="#000000" stroke-width="1" marker-end="url(#arrowhead)"/>
  <text x="130" y="165" font-family="Arial" font-size="10">3: submitBookingForm(formData)</text>
  
  <!-- 4. BookingView forwards to Controller -->
  <line x1="235" y1="180" x2="385" y2="180" stroke="#000000" stroke-width="1" marker-end="url(#arrowhead)"/>
  <text x="280" y="175" font-family="Arial" font-size="10">4: handleBookingSubmission(formData)</text>
  
  <!-- 5. Controller validates patient -->
  <line x1="395" y1="210" x2="545" y2="210" stroke="#000000" stroke-width="1" marker-end="url(#arrowhead)"/>
  <text x="450" y="205" font-family="Arial" font-size="10">5: validatePatient(patientId)</text>
  
  <!-- 6. Patient validation response -->
  <line x1="545" y1="230" x2="395" y2="230" stroke="#000000" stroke-width="1" marker-end="url(#arrowhead)"/>
  <text x="450" y="225" font-family="Arial" font-size="10">6: return validationResult</text>
  
  <!-- 7. Controller gets patient details -->
  <line x1="395" y1="250" x2="545" y2="250" stroke="#000000" stroke-width="1" marker-end="url(#arrowhead)"/>
  <text x="450" y="245" font-family="Arial" font-size="10">7: getPatientDetails(patientId)</text>
  
  <!-- 8. Patient details response -->
  <line x1="545" y1="270" x2="395" y2="270" stroke="#000000" stroke-width="1" marker-end="url(#arrowhead)"/>
  <text x="450" y="265" font-family="Arial" font-size="10">8: return patientDetails</text>
  
  <!-- 9. Controller checks specialist availability -->
  <line x1="395" y1="330" x2="695" y2="330" stroke="#000000" stroke-width="1" marker-end="url(#arrowhead)"/>
  <text x="520" y="325" font-family="Arial" font-size="10">9: checkAvailability(specialistId, dateTime)</text>
  
  <!-- 10. Specialist availability response -->
  <line x1="695" y1="350" x2="395" y2="350" stroke="#000000" stroke-width="1" marker-end="url(#arrowhead)"/>
  <text x="520" y="345" font-family="Arial" font-size="10">10: return availabilityStatus</text>
  
  <!-- 11. Controller gets specialist details -->
  <line x1="395" y1="370" x2="695" y2="370" stroke="#000000" stroke-width="1" marker-end="url(#arrowhead)"/>
  <text x="520" y="365" font-family="Arial" font-size="10">11: getSpecialistDetails(specialistId)</text>
  
  <!-- 12. Specialist details response -->
  <line x1="695" y1="390" x2="395" y2="390" stroke="#000000" stroke-width="1" marker-end="url(#arrowhead)"/>
  <text x="520" y="385" font-family="Arial" font-size="10">12: return specialistDetails</text>
  
  <!-- Decision point -->
  <rect x="370" y="410" width="40" height="30" fill="#FFCCCC" stroke="#CC0000" stroke-width="2"/>
  <text x="390" y="430" text-anchor="middle" font-family="Arial" font-size="10" font-weight="bold">ALT</text>
  
  <!-- Alternative 1: Available -->
  <rect x="350" y="450" width="500" height="80" fill="none" stroke="#808080" stroke-width="1" stroke-dasharray="3,3"/>
  <text x="360" y="470" font-family="Arial" font-size="10" font-weight="bold">[specialist available]</text>
  
  <!-- 13. Controller creates consultation -->
  <line x1="395" y1="490" x2="855" y2="490" stroke="#000000" stroke-width="1" marker-end="url(#arrowhead)"/>
  <text x="600" y="485" font-family="Arial" font-size="10">13: createConsultation(bookingData)</text>
  
  <!-- 14. Consultation created response -->
  <line x1="855" y1="510" x2="395" y2="510" stroke="#000000" stroke-width="1" marker-end="url(#arrowhead)"/>
  <text x="600" y="505" font-family="Arial" font-size="10">14: return consultationId</text>
  
  <!-- Alternative 2: Not Available -->
  <rect x="350" y="540" width="500" height="40" fill="none" stroke="#808080" stroke-width="1" stroke-dasharray="3,3"/>
  <text x="360" y="560" font-family="Arial" font-size="10" font-weight="bold">[specialist not available]</text>
  <text x="370" y="575" font-family="Arial" font-size="10">Controller suggests alternative times</text>
  
  <!-- 15. Controller sends response to view -->
  <line x1="385" y1="590" x2="235" y2="590" stroke="#000000" stroke-width="1" marker-end="url(#arrowhead)"/>
  <text x="280" y="585" font-family="Arial" font-size="10">15: sendBookingResponse(result)</text>
  
  <!-- 16. View displays confirmation to patient -->
  <line x1="225" y1="610" x2="95" y2="610" stroke="#000000" stroke-width="1" marker-end="url(#arrowhead)"/>
  <text x="120" y="605" font-family="Arial" font-size="10">16: displayConfirmation(message)</text>
  
  <!-- Arrow marker definition -->
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="black"/>
    </marker>
  </defs>
  
  <!-- Notes -->
  <rect x="50" y="665" width="900" height="25" fill="#F0F0F0" stroke="#000000" stroke-width="1"/>
  <text x="60" y="680" font-family="Arial" font-size="10" font-weight="bold">Notes:</text>
  <text x="120" y="680" font-family="Arial" font-size="10">ALT = Alternative flows based on conditions</text>
  <text x="400" y="680" font-family="Arial" font-size="10">Dashed lines = Lifelines</text>
  <text x="600" y="680" font-family="Arial" font-size="10">Solid lines with arrows = Messages</text>
</svg>