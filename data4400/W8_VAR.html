<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Week 8: Vector Autoregression (VAR) and Multivariate Methods</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Helvetica, Arial, sans-serif;
            background: white;
            color: #333;
            overflow: hidden;
        }

        .slide {
            display: none;
            width: 100vw;
            height: 100vh;
            padding: 60px 80px;
            background: white;
        }

        .slide.active {
            display: flex;
            flex-direction: column;
        }

        h1 {
            color: #DC143C;
            font-size: 48px;
            margin-bottom: 30px;
            font-weight: bold;
        }

        h2 {
            color: #DC143C;
            font-size: 36px;
            margin-bottom: 25px;
            font-weight: bold;
        }

        h3 {
            color: #DC143C;
            font-size: 28px;
            margin-bottom: 20px;
            font-weight: bold;
        }

        p {
            font-size: 22px;
            line-height: 1.6;
            margin-bottom: 20px;
        }

        ul, ol {
            margin-left: 40px;
            font-size: 22px;
            line-height: 1.8;
        }

        .subtitle {
            font-size: 28px;
            color: #555;
            margin-bottom: 40px;
        }

        .navigation {
            position: fixed;
            bottom: 30px;
            right: 30px;
            display: flex;
            gap: 15px;
            z-index: 1000;
        }

        button {
            padding: 12px 24px;
            font-size: 18px;
            background: #DC143C;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-family: Helvetica, Arial, sans-serif;
        }

        button:hover {
            background: #B01030;
        }

        button:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .slide-number {
            position: fixed;
            bottom: 30px;
            left: 30px;
            font-size: 18px;
            color: #666;
        }

        .chart-container {
            width: 100%;
            max-width: 800px;
            height: 400px;
            margin: 30px auto;
        }

        .two-column {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 40px;
            margin-top: 20px;
        }

        .box {
            border: 2px solid #DC143C;
            padding: 20px;
            border-radius: 8px;
            background: #fff;
        }

        .highlight {
            background: #FFF5F5;
            padding: 20px;
            border-left: 4px solid #DC143C;
            margin: 20px 0;
        }

        .quiz {
            background: #F8F8F8;
            padding: 30px;
            border-radius: 8px;
            margin-top: 30px;
        }

        .quiz-option {
            display: block;
            padding: 15px;
            margin: 10px 0;
            background: white;
            border: 2px solid #ddd;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .quiz-option:hover {
            border-color: #DC143C;
            background: #FFF5F5;
        }

        .quiz-option.correct {
            border-color: #28a745;
            background: #d4edda;
        }

        .quiz-option.incorrect {
            border-color: #dc3545;
            background: #f8d7da;
        }

        .feedback {
            margin-top: 15px;
            padding: 15px;
            border-radius: 5px;
            display: none;
        }

        .feedback.show {
            display: block;
        }

        .feedback.correct {
            background: #d4edda;
            color: #155724;
            border: 1px solid #28a745;
        }

        .feedback.incorrect {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #dc3545;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            font-size: 20px;
        }

        th, td {
            padding: 12px;
            text-align: left;
            border: 1px solid #ddd;
        }

        th {
            background: #DC143C;
            color: white;
        }

        tr:nth-child(even) {
            background: #f9f9f9;
        }

        .equation {
            font-size: 24px;
            font-family: 'Courier New', monospace;
            background: #f8f8f8;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
            text-align: center;
        }

        .logo {
            position: fixed;
            bottom: 30px;
            right: 150px;
            font-weight: bold;
            color: #DC143C;
            font-size: 16px;
        }

        .activity-box {
            background: #FFF9E6;
            border: 2px solid #FFC107;
            padding: 25px;
            border-radius: 8px;
            margin-top: 20px;
        }

        .grid-3 {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-top: 20px;
        }

        .example-box {
            background: #E8F4F8;
            border-left: 4px solid #2196F3;
            padding: 20px;
            margin: 20px 0;
        }

        strong {
            color: #DC143C;
        }

        .visual-diagram {
            width: 100%;
            max-width: 700px;
            margin: 30px auto;
        }
    </style>
</head>
<body>

<!-- Slide 1: Title -->
<div class="slide active">
    <div style="display: flex; flex-direction: column; justify-content: center; align-items: center; height: 100%; text-align: center;">
        <h1 style="font-size: 56px; margin-bottom: 20px;">DATA4400</h1>
        <h2 style="color: #555; font-weight: normal; margin-bottom: 40px;">Data-Driven Forecasting</h2>
        <h1 style="font-size: 52px; margin-bottom: 30px;">Week 8</h1>
        <div class="subtitle" style="font-size: 32px;">Vector Autoregression (VAR) and Multivariate Methods</div>
    </div>
</div>

<!-- Slide 2: Course Roadmap -->
<div class="slide">
    <h2>DATA4400 Course Roadmap</h2>
    <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; margin-top: 30px;">
        <div class="box" style="opacity: 0.5;">
            <strong>Week 1-4</strong><br>Foundations
        </div>
        <div class="box" style="opacity: 0.5;">
            <strong>Week 5-6</strong><br>Prophet & Assessment 1
        </div>
        <div class="box" style="opacity: 0.5;">
            <strong>Week 7</strong><br>ARIMA & SARIMA
        </div>
        <div class="box" style="background: #FFF5F5;">
            <strong>Week 8</strong><br>VAR & Multivariate Methods
        </div>
    </div>
    <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; margin-top: 15px;">
        <div class="box" style="opacity: 0.5;">
            <strong>Week 9</strong><br>Assessment 2
        </div>
        <div class="box" style="opacity: 0.5;">
            <strong>Week 10</strong><br>End-to-End Solutions
        </div>
        <div class="box" style="opacity: 0.5;">
            <strong>Week 11</strong><br>Adaptive Forecasting
        </div>
        <div class="box" style="opacity: 0.5;">
            <strong>Week 12</strong><br>Assessment 3
        </div>
    </div>
    <div class="highlight" style="margin-top: 40px;">
        <strong>Today's Focus:</strong> Moving from single variable forecasting to systems where multiple variables influence each other
    </div>
</div>

<!-- Slide 3: Learning Outcomes -->
<div class="slide">
    <h2>Learning Outcomes</h2>
    <p style="margin-top: 30px;">By the end of this lesson, you will be able to:</p>
    <ol style="margin-top: 30px; font-size: 24px;">
        <li style="margin-bottom: 25px;"><strong>Distinguish</strong> between correlation and causation in business contexts, recognizing when relationships are merely coincidental versus potentially causal</li>
        <li style="margin-bottom: 25px;"><strong>Apply</strong> Granger causality tests to identify whether past values of one variable help predict another variable</li>
        <li style="margin-bottom: 25px;"><strong>Build</strong> Vector Autoregression (VAR) models to forecast multiple related business variables simultaneously</li>
        <li style="margin-bottom: 25px;"><strong>Interpret</strong> VAR model outputs and make evidence-based business recommendations</li>
    </ol>
</div>

<!-- Slide 4: The Business Problem -->
<div class="slide">
    <h2>The Business Problem: A Costly Mistake</h2>
    <div class="example-box" style="font-size: 20px;">
        <strong>Case Study: RetailCo's Marketing Disaster</strong>
        <p>In 2018, RetailCo noticed that sales increased whenever they saw higher social media engagement. Their analysis showed a strong correlation of 0.85 between social media mentions and weekly sales.</p>
        <p><strong>Their decision:</strong> Invest $2 million in a social media campaign to boost mentions.</p>
        <p><strong>The result:</strong> Social media mentions increased by 300%, but sales remained flat.</p>
        <p><strong>What went wrong?</strong></p>
    </div>
    <div class="highlight">
        <p><strong>The Real Story:</strong> Both social media mentions AND sales were driven by seasonal shopping periods (holidays, back-to-school). Social media didn't cause sales—they both responded to the same underlying factor.</p>
        <p style="margin-top: 15px;"><strong>Cost of confusion:</strong> $2 million + opportunity cost</p>
    </div>
    <p style="margin-top: 30px; font-size: 24px; color: #DC143C;"><strong>Key Question:</strong> How can we determine if one variable actually influences another, or if they just happen to move together?</p>
</div>

<!-- Slide 5: Correlation Examples -->
<div class="slide">
    <h2>When Correlations Mislead</h2>
    <canvas id="correlationChart" style="max-height: 400px;"></canvas>
    <p style="text-align: center; margin-top: 20px; font-style: italic;">Maine divorce rate vs. per capita margarine consumption (r = 0.99)</p>
    <div class="highlight" style="margin-top: 30px;">
        <strong>The Danger:</strong> High correlation does not imply causation. With enough data, you can find spurious (meaningless) correlations between any two trending variables.
    </div>
</div>

<!-- Slide 6: Quiz 1 - Correlation vs Causation -->
<div class="slide">
    <h2>Quiz 1: Correlation or Causation?</h2>
    <div class="quiz">
        <p style="font-size: 24px; margin-bottom: 20px;"><strong>Scenario:</strong> A retail company observes that stores with more parking spaces have higher sales. They conclude that building more parking spaces will increase sales.</p>
        <p style="font-size: 22px; margin-bottom: 25px;">What is the most likely explanation?</p>
        <div class="quiz-option" onclick="checkAnswer(this, false, 1)">
            A) More parking spaces directly cause higher sales
        </div>
        <div class="quiz-option" onclick="checkAnswer(this, false, 1)">
            B) Higher sales cause the company to build more parking spaces
        </div>
        <div class="quiz-option" onclick="checkAnswer(this, true, 1)">
            C) Both are correlated with store size and location—larger stores in busier areas have both more parking and higher sales
        </div>
        <div class="quiz-option" onclick="checkAnswer(this, false, 1)">
            D) This is a spurious correlation with no relationship
        </div>
        <div class="feedback" id="feedback1"></div>
    </div>
</div>

<!-- Slide 7: Understanding Causation -->
<div class="slide">
    <h2>What is Causation?</h2>
    <div class="two-column">
        <div>
            <h3>Correlation</h3>
            <ul>
                <li>Two variables move together</li>
                <li>Statistical relationship</li>
                <li>Can be measured with correlation coefficient (-1 to +1)</li>
                <li>Says nothing about direction or mechanism</li>
            </ul>
        </div>
        <div>
            <h3>Causation</h3>
            <ul>
                <li>One variable causes changes in another</li>
                <li>Directional relationship</li>
                <li>Implies mechanism of influence</li>
                <li>Requires evidence beyond correlation</li>
            </ul>
        </div>
    </div>
    <div class="highlight" style="margin-top: 40px;">
        <strong>Definition:</strong> Causation implies that the existence or change in one variable (the cause) produces or influences the occurrence or change in another variable (the effect). This relationship must occur before or simultaneously with the effect.
    </div>
</div>

<!-- Slide 8: Classic Example -->
<div class="slide">
    <h2>The Ice Cream and Sunburn Example</h2>
    <div class="visual-diagram">
        <svg viewBox="0 0 600 300" style="width: 100%;">
            <!-- Hot Weather -->
            <circle cx="300" cy="50" r="40" fill="#FFC107" stroke="#DC143C" stroke-width="3"/>
            <text x="300" y="58" text-anchor="middle" font-size="18" font-weight="bold">Hot Weather</text>
            
            <!-- Arrows down -->
            <line x1="250" y1="90" x2="150" y2="180" stroke="#DC143C" stroke-width="3" marker-end="url(#arrowred)"/>
            <line x1="350" y1="90" x2="450" y2="180" stroke="#DC143C" stroke-width="3" marker-end="url(#arrowred)"/>
            
            <!-- Ice Cream -->
            <rect x="80" y="200" width="140" height="80" fill="#E8F4F8" stroke="#2196F3" stroke-width="3" rx="10"/>
            <text x="150" y="245" text-anchor="middle" font-size="18" font-weight="bold">Ice Cream</text>
            <text x="150" y="265" text-anchor="middle" font-size="16">Consumption</text>
            
            <!-- Sunburn -->
            <rect x="380" y="200" width="140" height="80" fill="#FFE8E8" stroke="#DC143C" stroke-width="3" rx="10"/>
            <text x="450" y="245" text-anchor="middle" font-size="18" font-weight="bold">Sunburn</text>
            <text x="450" y="265" text-anchor="middle" font-size="16">Cases</text>
            
            <!-- Correlation line (dashed) -->
            <line x1="220" y1="240" x2="380" y2="240" stroke="#999" stroke-width="2" stroke-dasharray="5,5"/>
            <text x="300" y="230" text-anchor="middle" font-size="14" fill="#666">Correlated</text>
            
            <!-- Arrow marker definition -->
            <defs>
                <marker id="arrowred" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
                    <path d="M0,0 L0,6 L9,3 z" fill="#DC143C" />
                </marker>
            </defs>
        </svg>
    </div>
    <div class="two-column" style="margin-top: 40px;">
        <div class="box">
            <strong>The Correlation:</strong>
            <p>Ice cream consumption and sunburn rates are highly correlated</p>
        </div>
        <div class="box">
            <strong>The Reality:</strong>
            <p>Hot weather causes both—ice cream doesn't cause sunburn</p>
        </div>
    </div>
</div>

<!-- Slide 9: Activity - Hospital Mortality -->
<div class="slide">
    <h2>Activity 1: The Hospital Paradox</h2>
    <div class="activity-box">
        <p style="font-size: 24px; margin-bottom: 20px;"><strong>Statement:</strong> "There is a higher mortality rate in hospitals compared to the general population."</p>
        <p style="font-size: 22px; margin-bottom: 30px;">Discuss in groups:</p>
        <ol style="font-size: 22px;">
            <li style="margin-bottom: 15px;">Based on this statement, should people avoid hospitals?</li>
            <li style="margin-bottom: 15px;">Do hospitals cause mortality?</li>
            <li style="margin-bottom: 15px;">How would you design an experiment to test the causal relationship?</li>
        </ol>
    </div>
    <div class="highlight" style="margin-top: 30px;">
        <strong>Think about:</strong> What is the confounding variable here? What makes hospital populations different from the general population?
    </div>
</div>

<!-- Slide 10: Establishing Causation -->
<div class="slide">
    <h2>How Do We Establish Causation?</h2>
    <div class="grid-3">
        <div class="box">
            <h3 style="font-size: 22px;">1. Temporal Order</h3>
            <p>The cause must occur before the effect</p>
        </div>
        <div class="box">
            <h3 style="font-size: 22px;">2. Covariation</h3>
            <p>Changes in the cause relate to changes in the effect</p>
        </div>
        <div class="box">
            <h3 style="font-size: 22px;">3. No Confounders</h3>
            <p>No third variable explains the relationship</p>
        </div>
    </div>
    <div style="margin-top: 40px;">
        <h3>Methods to Establish Causation:</h3>
        <table>
            <tr>
                <th>Method</th>
                <th>Strength</th>
                <th>Limitation</th>
            </tr>
            <tr>
                <td><strong>Randomized Controlled Trials (RCT)</strong></td>
                <td>Gold standard—controls for confounders</td>
                <td>Expensive, often unethical or impractical</td>
            </tr>
            <tr>
                <td><strong>Natural Experiments</strong></td>
                <td>Uses real-world variations</td>
                <td>Hard to find suitable scenarios</td>
            </tr>
            <tr>
                <td><strong>Statistical Tests (Granger)</strong></td>
                <td>Practical, uses existing data</td>
                <td>Tests prediction, not true causation</td>
            </tr>
        </table>
    </div>
</div>

<!-- Slide 11: Quiz 2 - Causation Methods -->
<div class="slide">
    <h2>Quiz 2: Testing Causation</h2>
    <div class="quiz">
        <p style="font-size: 24px; margin-bottom: 20px;"><strong>Scenario:</strong> A coffee company wants to know if their TV advertising causes sales increases.</p>
        <p style="font-size: 22px; margin-bottom: 25px;">Which approach would provide the strongest evidence of causation?</p>
        <div class="quiz-option" onclick="checkAnswer(this, false, 2)">
            A) Calculate the correlation between advertising spend and sales
        </div>
        <div class="quiz-option" onclick="checkAnswer(this, true, 2)">
            B) Run ads in randomly selected cities while keeping others as control groups, then compare sales
        </div>
        <div class="quiz-option" onclick="checkAnswer(this, false, 2)">
            C) Survey customers about whether they saw the ads
        </div>
        <div class="quiz-option" onclick="checkAnswer(this, false, 2)">
            D) Wait and see if sales increase after the campaign
        </div>
        <div class="feedback" id="feedback2"></div>
    </div>
</div>

<!-- Slide 12: Introduction to Granger Causality -->
<div class="slide">
    <h2>Enter Granger Causality: A Practical Tool</h2>
    <div class="highlight">
        <p style="font-size: 26px;"><strong>The Core Idea:</strong> If past values of variable X help predict future values of variable Y (beyond what Y's own history tells us), then X "Granger-causes" Y.</p>
    </div>
    <div class="visual-diagram" style="margin-top: 40px;">
        <svg viewBox="0 0 700 200" style="width: 100%;">
            <!-- Timeline -->
            <line x1="50" y1="100" x2="650" y2="100" stroke="#333" stroke-width="2" marker-end="url(#arrow)"/>
            
            <!-- Time points -->
            <circle cx="150" cy="100" r="8" fill="#DC143C"/>
            <text x="150" y="130" text-anchor="middle" font-size="16">X(t-2)</text>
            
            <circle cx="250" cy="100" r="8" fill="#DC143C"/>
            <text x="250" y="130" text-anchor="middle" font-size="16">X(t-1)</text>
            
            <circle cx="350" cy="100" r="8" fill="#2196F3"/>
            <text x="350" y="70" text-anchor="middle" font-size="16">Now</text>
            
            <circle cx="450" cy="100" r="8" fill="#4CAF50"/>
            <text x="450" y="130" text-anchor="middle" font-size="16">Y(t+1)</text>
            
            <circle cx="550" cy="100" r="8" fill="#4CAF50"/>
            <text x="550" y="130" text-anchor="middle" font-size="16">Y(t+2)</text>
            
            <!-- Arrow to prediction -->
            <path d="M 250 95 Q 350 50 450 95" stroke="#DC143C" stroke-width="2" fill="none" stroke-dasharray="5,5" marker-end="url(#arrowred2)"/>
            <text x="350" y="40" text-anchor="middle" font-size="14" fill="#DC143C">Does past X help predict future Y?</text>
            
            <defs>
                <marker id="arrow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
                    <path d="M0,0 L0,6 L9,3 z" fill="#333" />
                </marker>
                <marker id="arrowred2" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
                    <path d="M0,0 L0,6 L9,3 z" fill="#DC143C" />
                </marker>
            </defs>
        </svg>
    </div>
    <div class="two-column" style="margin-top: 40px;">
        <div class="box">
            <strong>Question 1:</strong><br>Does including X's past improve our forecast of Y?
        </div>
        <div class="box">
            <strong>Question 2:</strong><br>Is this improvement statistically significant?
        </div>
    </div>
</div>

<!-- Slide 13: Granger Causality Definition -->
<div class="slide">
    <h2>Granger Causality: Formal Definition</h2>
    <div class="example-box">
        <p style="font-size: 24px;"><strong>Granger Causality Principle:</strong></p>
        <p style="font-size: 22px; margin-top: 15px;">Variable X₁ "Granger-causes" variable X₂ if:</p>
        <ol style="font-size: 22px; margin-top: 15px;">
            <li>X₁ occurs before X₂</li>
            <li>Past values of X₁ contain information that helps predict X₂ beyond the information contained in past values of X₂ alone</li>
            <li>Including X₁ in the forecasting model reduces prediction error</li>
        </ol>
    </div>
    <div class="highlight" style="margin-top: 30px; background: #FFE8E8;">
        <p style="font-size: 24px;"><strong>⚠️ Critical Warning:</strong></p>
        <p style="font-size: 22px; margin-top: 10px;">Granger causality tests <strong>forecasting ability</strong>, not true causation. It identifies predictive relationships but cannot prove that X actually causes Y.</p>
    </div>
    <div style="margin-top: 30px;">
        <h3>Why Use Granger Causality?</h3>
        <ul style="font-size: 22px;">
            <li>Practical—uses historical data you already have</li>
            <li>No need for experiments or interventions</li>
            <li>Helps identify which variables are useful predictors</li>
            <li>Guides business decisions about where to focus resources</li>
        </ul>
    </div>
</div>

<!-- Slide 14: Granger Causality Example -->
<div class="slide">
    <h2>Example: Social Media and Sales</h2>
    <canvas id="grangerChart" style="max-height: 400px;"></canvas>
    <div class="two-column" style="margin-top: 30px;">
        <div class="example-box">
            <strong>Test 1: Does social media Granger-cause sales?</strong>
            <p style="margin-top: 10px;">Compare two models:</p>
            <ul style="font-size: 20px;">
                <li>Model A: Predict sales using only past sales</li>
                <li>Model B: Predict sales using past sales + past social media</li>
            </ul>
            <p style="margin-top: 10px; color: #DC143C;"><strong>Result:</strong> Model B performs significantly better → Social media Granger-causes sales</p>
        </div>
        <div class="example-box">
            <strong>Test 2: Do sales Granger-cause social media?</strong>
            <p style="margin-top: 10px;">Compare two models:</p>
            <ul style="font-size: 20px;">
                <li>Model C: Predict social media using only past social media</li>
                <li>Model D: Predict social media using past social media + past sales</li>
            </ul>
            <p style="margin-top: 10px; color: #DC143C;"><strong>Result:</strong> No significant improvement → Sales do not Granger-cause social media</p>
        </div>
    </div>
</div>

<!-- Slide 15: When to Use Granger Causality -->
<div class="slide">
    <h2>Business Applications of Granger Causality</h2>
    <table style="margin-top: 30px;">
        <tr>
            <th>Business Question</th>
            <th>Variables to Test</th>
            <th>Business Value</th>
        </tr>
        <tr>
            <td>Does advertising drive sales?</td>
            <td>Ad spending → Sales revenue</td>
            <td>Optimize marketing budget allocation</td>
        </tr>
        <tr>
            <td>Do price changes affect demand?</td>
            <td>Price → Units sold</td>
            <td>Inform pricing strategy</td>
        </tr>
        <tr>
            <td>Does customer sentiment predict churn?</td>
            <td>Sentiment scores → Churn rate</td>
            <td>Early warning system for retention</td>
        </tr>
        <tr>
            <td>Do economic indicators predict our sales?</td>
            <td>GDP/Unemployment → Company sales</td>
            <td>Better demand forecasting</td>
        </tr>
    </table>
    <div class="highlight" style="margin-top: 30px;">
        <strong>Key Requirement:</strong> Data must be stationary (or made stationary through differencing) before conducting Granger causality tests.
    </div>
</div>

<!-- Slide 16: Quiz 3 - Granger Causality -->
<div class="slide">
    <h2>Quiz 3: Understanding Granger Causality</h2>
    <div class="quiz">
        <p style="font-size: 24px; margin-bottom: 20px;">A Granger causality test shows that Bitcoin tweet volume Granger-causes Bitcoin prices (p-value = 0.001).</p>
        <p style="font-size: 22px; margin-bottom: 25px;">What can we conclude?</p>
        <div class="quiz-option" onclick="checkAnswer(this, false, 3)">
            A) Twitter activity causes Bitcoin price changes
        </div>
        <div class="quiz-option" onclick="checkAnswer(this, true, 3)">
            B) Past Twitter activity helps predict future Bitcoin prices better than using past prices alone
        </div>
        <div class="quiz-option" onclick="checkAnswer(this, false, 3)">
            C) Bitcoin prices cause changes in Twitter activity
        </div>
        <div class="quiz-option" onclick="checkAnswer(this, false, 3)">
            D) Twitter and Bitcoin prices are uncorrelated
        </div>
        <div class="feedback" id="feedback3"></div>
    </div>
</div>

<!-- Slide 17: Introduction to VAR -->
<div class="slide">
    <h2>The Limitation of Single-Variable Models</h2>
    <div class="two-column">
        <div>
            <h3>ARIMA Models (Week 7)</h3>
            <ul style="font-size: 20px;">
                <li>Model one variable at a time</li>
                <li>Y(t) depends only on past Y values</li>
                <li>Cannot capture interactions between variables</li>
                <li>Assumes other variables are external/fixed</li>
            </ul>
            <div class="equation" style="margin-top: 20px;">
                Y<sub>t</sub> = c + φ₁Y<sub>t-1</sub> + φ₂Y<sub>t-2</sub> + ε<sub>t</sub>
            </div>
        </div>
        <div>
            <h3>Real Business Reality</h3>
            <ul style="font-size: 20px;">
                <li>Variables influence each other</li>
                <li>Sales affect inventory, which affects pricing, which affects sales</li>
                <li>Feedback loops are common</li>
                <li>Need a system of equations</li>
            </ul>
            <div class="box" style="margin-top: 20px; background: #FFF5F5;">
                <strong>Solution:</strong> Vector Autoregression (VAR) models multiple variables simultaneously
            </div>
        </div>
    </div>
</div>

<!-- Slide 18: VAR Visual Explanation -->
<div class="slide">
    <h2>How VAR Works: A Visual Explanation</h2>
    <div class="visual-diagram">
        <svg viewBox="0 0 700 400" style="width: 100%;">
            <!-- Time t-1 -->
            <text x="50" y="30" font-size="20" font-weight="bold" fill="#DC143C">Time (t-1)</text>
            <rect x="50" y="50" width="120" height="60" fill="#E8F4F8" stroke="#2196F3" stroke-width="2" rx="5"/>
            <text x="110" y="85" text-anchor="middle" font-size="16" font-weight="bold">Sales(t-1)</text>
            
            <rect x="50" y="150" width="120" height="60" fill="#FFE8E8" stroke="#DC143C" stroke-width="2" rx="5"/>
            <text x="110" y="185" text-anchor="middle" font-size="16" font-weight="bold">Advertising(t-1)</text>
            
            <!-- Time t -->
            <text x="350" y="30" font-size="20" font-weight="bold" fill="#DC143C">Time (t)</text>
            <rect x="300" y="50" width="120" height="60" fill="#E8F4F8" stroke="#2196F3" stroke-width="2" rx="5"/>
            <text x="360" y="85" text-anchor="middle" font-size="16" font-weight="bold">Sales(t)</text>
            
            <rect x="300" y="150" width="120" height="60" fill="#FFE8E8" stroke="#DC143C" stroke-width="2" rx="5"/>
            <text x="360" y="185" text-anchor="middle" font-size="16" font-weight="bold">Advertising(t)</text>
            
            <!-- Arrows showing relationships -->
            <!-- Sales(t-1) to Sales(t) -->
            <line x1="170" y1="80" x2="300" y2="80" stroke="#2196F3" stroke-width="2" marker-end="url(#arrowblue)"/>
            <text x="235" y="75" text-anchor="middle" font-size="12" fill="#2196F3">β₁₁</text>
            
            <!-- Advertising(t-1) to Sales(t) -->
            <line x1="170" y1="180" x2="300" y2="100" stroke="#DC143C" stroke-width="2" marker-end="url(#arrowred3)"/>
            <text x="210" y="140" font-size="12" fill="#DC143C">β₁₂</text>
            
            <!-- Sales(t-1) to Advertising(t) -->
            <line x1="170" y1="100" x2="300" y2="160" stroke="#2196F3" stroke-width="2" marker-end="url(#arrowblue)"/>
            <text x="210" y="135" font-size="12" fill="#2196F3">β₂₁</text>
            
            <!-- Advertising(t-1) to Advertising(t) -->
            <line x1="170" y1="180" x2="300" y2="180" stroke="#DC143C" stroke-width="2" marker-end="url(#arrowred3)"/>
            <text x="235" y="175" text-anchor="middle" font-size="12" fill="#DC143C">β₂₂</text>
            
            <!-- Feedback loop indicator -->
            <path d="M 420 80 Q 480 120 420 160" stroke="#4CAF50" stroke-width="3" fill="none" marker-end="url(#arrowgreen)"/>
            <text x="500" y="120" font-size="16" fill="#4CAF50" font-weight="bold">Feedback</text>
            
            <defs>
                <marker id="arrowblue" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
                    <path d="M0,0 L0,6 L9,3 z" fill="#2196F3" />
                </marker>
                <marker id="arrowred3" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
                    <path d="M0,0 L0,6 L9,3 z" fill="#DC143C" />
                </marker>
                <marker id="arrowgreen" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
                    <path d="M0,0 L0,6 L9,3 z" fill="#4CAF50" />
                </marker>
            </defs>
        </svg>
    </div>
    <div class="highlight">
        <strong>Key Insight:</strong> Each variable is predicted using the past values of ALL variables in the system, allowing for complex interactions and feedback loops.
    </div>
</div>

<!-- Slide 19: VAR Equations -->
<div class="slide">
    <h2>VAR Model: Mathematical Form</h2>
    <p>A VAR(1) model with two variables looks like this:</p>
    <div class="equation" style="font-size: 20px; text-align: left; padding: 25px;">
        <strong>Equation 1 (Sales):</strong><br>
        Sales<sub>t</sub> = c₁ + β₁₁ × Sales<sub>t-1</sub> + β₁₂ × Advertising<sub>t-1</sub> + ε₁<sub>t</sub>
        <br><br>
        <strong>Equation 2 (Advertising):</strong><br>
        Advertising<sub>t</sub> = c₂ + β₂₁ × Sales<sub>t-1</sub> + β₂₂ × Advertising<sub>t-1</sub> + ε₂<sub>t</sub>
    </div>
    <div class="two-column" style="margin-top: 30px;">
        <div class="box">
            <strong>β₁₁:</strong> Effect of past sales on current sales<br>
            <strong>β₁₂:</strong> Effect of past advertising on current sales
        </div>
        <div class="box">
            <strong>β₂₁:</strong> Effect of past sales on current advertising<br>
            <strong>β₂₂:</strong> Effect of past advertising on current advertising
        </div>
    </div>
    <div class="highlight" style="margin-top: 30px;">
        <strong>General Form:</strong> VAR(p) includes p lags of each variable. We use information criteria (BIC/AIC) to select the optimal number of lags.
    </div>
</div>

<!-- Slide 20: VAR Characteristics -->
<div class="slide">
    <h2>Key Characteristics of VAR Models</h2>
    <table style="margin-top: 30px; font-size: 20px;">
        <tr>
            <th>Characteristic</th>
            <th>Description</th>
            <th>Implication</th>
        </tr>
        <tr>
            <td><strong>Endogenous Variables</strong></td>
            <td>All variables influence each other equally</td>
            <td>No predetermined causal structure—the data reveals relationships</td>
        </tr>
        <tr>
            <td><strong>System of Equations</strong></td>
            <td>One equation per variable</td>
            <td>Each variable has its own forecasting equation</td>
        </tr>
        <tr>
            <td><strong>Symmetric Treatment</strong></td>
            <td>Same lag structure for all variables</td>
            <td>If we use 2 lags, we use 2 lags of every variable in every equation</td>
        </tr>
        <tr>
            <td><strong>Requires Stationarity</strong></td>
            <td>Variables must be stationary or differenced</td>
            <td>May need to transform data before modeling</td>
        </tr>
    </table>
    <div class="example-box" style="margin-top: 30px;">
        <strong>Example:</strong> A VAR(2) model with 3 variables (Sales, Advertising, Price) creates 3 equations, each with 6 lagged terms (2 lags × 3 variables) plus a constant.
    </div>
</div>

<!-- Slide 21: Why Use VAR -->
<div class="slide">
    <h2>Advantages of VAR Models</h2>
    <div class="grid-3">
        <div class="box">
            <h3 style="font-size: 20px;">1. Captures Interactions</h3>
            <p style="font-size: 18px;">Models how variables influence each other, not just how they move together</p>
        </div>
        <div class="box">
            <h3 style="font-size: 20px;">2. Better Forecasts</h3>
            <p style="font-size: 18px;">Often outperforms univariate models by leveraging cross-variable information</p>
        </div>
        <div class="box">
            <h3 style="font-size: 20px;">3. System Dynamics</h3>
            <p style="font-size: 18px;">Reveals how shocks propagate through the system over time</p>
        </div>
    </div>
    <div style="margin-top: 40px;">
        <h3>When to Use VAR Models</h3>
        <table>
            <tr>
                <th style="width: 40%;">Scenario</th>
                <th>Best Approach</th>
            </tr>
            <tr>
                <td>Single time series, no external variables</td>
                <td>ARIMA/SARIMA (Week 7)</td>
            </tr>
            <tr>
                <td>Y depends on X, but X doesn't depend on Y</td>
                <td>Regression with lagged predictors (Week 9)</td>
            </tr>
            <tr>
                <td style="background: #FFF5F5;"><strong>Multiple variables influencing each other</strong></td>
                <td style="background: #FFF5F5;"><strong>VAR Models (Week 8)</strong></td>
            </tr>
        </table>
    </div>
</div>

<!-- Slide 22: Building a VAR Model -->
<div class="slide">
    <h2>Building a VAR Model: Step-by-Step</h2>
    <ol style="font-size: 22px; margin-top: 30px;">
        <li style="margin-bottom: 25px;">
            <strong>Check Stationarity</strong>
            <ul style="margin-top: 10px;">
                <li>Use ADF test for each variable</li>
                <li>If non-stationary, difference the data</li>
            </ul>
        </li>
        <li style="margin-bottom: 25px;">
            <strong>Determine Lag Order</strong>
            <ul style="margin-top: 10px;">
                <li>Use information criteria (BIC preferred for VAR)</li>
                <li>Balance model fit with complexity</li>
            </ul>
        </li>
        <li style="margin-bottom: 25px;">
            <strong>Estimate the Model</strong>
            <ul style="margin-top: 10px;">
                <li>Fit VAR(p) using selected lag order</li>
                <li>Obtain coefficients for each equation</li>
            </ul>
        </li>
        <li style="margin-bottom: 25px;">
            <strong>Diagnostic Checking</strong>
            <ul style="margin-top: 10px;">
                <li>Check residuals for autocorrelation</li>
                <li>Verify model stability</li>
            </ul>
        </li>
        <li style="margin-bottom: 25px;">
            <strong>Forecast</strong>
            <ul style="margin-top: 10px;">
                <li>Generate multi-step ahead forecasts</li>
                <li>Compute prediction intervals</li>
            </ul>
        </li>
    </ol>
</div>

<!-- Slide 23: Interpreting VAR Output -->
<div class="slide">
    <h2>Interpreting VAR Model Output</h2>
    <div class="example-box">
        <strong>Example Results: Retail Sales and Advertising VAR(1)</strong>
    </div>
    <table style="margin-top: 20px; font-size: 18px;">
        <tr>
            <th>Equation</th>
            <th>Variable</th>
            <th>Coefficient</th>
            <th>P-value</th>
            <th>Interpretation</th>
        </tr>
        <tr>
            <td rowspan="2"><strong>Sales</strong></td>
            <td>Sales<sub>t-1</sub></td>
            <td>0.85</td>
            <td>&lt;0.001</td>
            <td>Strong persistence: 85% of last period's sales carry over</td>
        </tr>
        <tr>
            <td>Advertising<sub>t-1</sub></td>
            <td>0.42</td>
            <td>0.003</td>
            <td>Advertising has significant positive effect on sales</td>
        </tr>
        <tr>
            <td rowspan="2"><strong>Advertising</strong></td>
            <td>Sales<sub>t-1</sub></td>
            <td>0.15</td>
            <td>0.089</td>
            <td>Weak feedback: higher sales lead to slightly more advertising</td>
        </tr>
        <tr>
            <td>Advertising<sub>t-1</sub></td>
            <td>0.68</td>
            <td>&lt;0.001</td>
            <td>Advertising spending is fairly persistent</td>
        </tr>
    </table>
    <div class="highlight" style="margin-top: 30px;">
        <strong>Business Insight:</strong> Advertising Granger-causes sales (0.42 coefficient, p=0.003), but sales do not significantly Granger-cause advertising (0.15 coefficient, p=0.089). This suggests advertising drives sales, not the other way around.
    </div>
</div>

<!-- Slide 24: Forecasting with VAR -->
<div class="slide">
    <h2>Forecasting with VAR Models</h2>
    <canvas id="varForecastChart" style="max-height: 400px;"></canvas>
    <div class="two-column" style="margin-top: 30px;">
        <div class="box">
            <strong>One-Step Ahead:</strong>
            <p style="font-size: 18px; margin-top: 10px;">Use most recent actual values of all variables</p>
            <div class="equation" style="font-size: 16px;">
                Ŷ<sub>t+1</sub> = f(Y<sub>t</sub>, X<sub>t</sub>, ...)
            </div>
        </div>
        <div class="box">
            <strong>Multi-Step Ahead:</strong>
            <p style="font-size: 18px; margin-top: 10px;">Use forecasted values as inputs for subsequent forecasts</p>
            <div class="equation" style="font-size: 16px;">
                Ŷ<sub>t+2</sub> = f(Ŷ<sub>t+1</sub>, X̂<sub>t+1</sub>, ...)
            </div>
        </div>
    </div>
    <div class="highlight" style="margin-top: 30px;">
        <strong>Important:</strong> Forecast uncertainty increases with the forecast horizon. Multi-step forecasts depend on earlier forecasts, so errors compound.
    </div>
</div>

<!-- Slide 25: Quiz 4 - VAR Models -->
<div class="slide">
    <h2>Quiz 4: VAR Model Understanding</h2>
    <div class="quiz">
        <p style="font-size: 24px; margin-bottom: 20px;">You're modeling the relationship between three variables: Sales, Price, and Customer Traffic. You want to build a VAR(2) model.</p>
        <p style="font-size: 22px; margin-bottom: 25px;">How many total coefficients (excluding constants) will your model have?</p>
        <div class="quiz-option" onclick="checkAnswer(this, false, 4)">
            A) 6 coefficients (2 lags × 3 variables)
        </div>
        <div class="quiz-option" onclick="checkAnswer(this, false, 4)">
            B) 9 coefficients (3 equations × 3 variables)
        </div>
        <div class="quiz-option" onclick="checkAnswer(this, true, 4)">
            C) 18 coefficients (3 equations × 3 variables × 2 lags)
        </div>
        <div class="quiz-option" onclick="checkAnswer(this, false, 4)">
            D) 12 coefficients (3 equations × 4 lags)
        </div>
        <div class="feedback" id="feedback4"></div>
    </div>
</div>

<!-- Slide 26: Activity - Python VAR -->
<div class="slide">
    <h2>Activity 2: Building Your First VAR Model</h2>
    <div class="activity-box">
        <p style="font-size: 24px; margin-bottom: 20px;"><strong>Hands-On Exercise: Retail Sales Forecasting</strong></p>
        <p style="font-size: 20px; margin-bottom: 20px;">We'll build a VAR model using a retail dataset with two variables:</p>
        <ul style="font-size: 20px; margin-bottom: 25px;">
            <li><strong>Sales:</strong> Monthly sales revenue ($1000s)</li>
            <li><strong>Advertising:</strong> Monthly advertising spend ($1000s)</li>
        </ul>
        <p style="font-size: 20px; margin-bottom: 15px;"><strong>Tasks:</strong></p>
        <ol style="font-size: 20px;">
            <li>Test for stationarity and difference if needed</li>
            <li>Determine optimal lag order using BIC</li>
            <li>Fit the VAR model</li>
            <li>Test for Granger causality</li>
            <li>Generate 12-month forecasts</li>
            <li>Interpret the business implications</li>
        </ol>
    </div>
    <p style="font-size: 20px; margin-top: 25px; color: #DC143C;"><strong>Open:</strong> DATA4400_W8_VAR_RetailSales.ipynb</p>
</div>

<!-- Slide 27: Activity - Orange Data Mining -->
<div class="slide">
    <h2>Activity 3: VAR in Orange Data Mining</h2>
    <div class="activity-box">
        <p style="font-size: 24px; margin-bottom: 20px;"><strong>Visual Exploration with Orange</strong></p>
        <p style="font-size: 20px; margin-bottom: 20px;">We'll use Orange's visual workflow to:</p>
        <ol style="font-size: 20px; margin-bottom: 25px;">
            <li>Load multivariate time series data</li>
            <li>Apply VAR model widget</li>
            <li>Compare VAR performance against ARIMA</li>
            <li>Run Granger causality tests</li>
            <li>Visualize forecast results</li>
        </ol>
        <div class="box" style="margin-top: 20px; background: #E8F4F8;">
            <strong>Workflow:</strong><br>
            CSV File Import → As Timeseries → Select Columns → VAR Model → Model Evaluation → Granger Causality → Line Chart
        </div>
    </div>
    <p style="font-size: 20px; margin-top: 25px;">Try different datasets: ApplesPears.xlsx, TelecomEHW.xlsx</p>
</div>

<!-- Slide 28: Decision Framework -->
<div class="slide">
    <h2>Choosing the Right Forecasting Method</h2>
    <table style="margin-top: 30px; font-size: 19px;">
        <tr>
            <th>Your Situation</th>
            <th>Recommended Method</th>
            <th>Example</th>
        </tr>
        <tr>
            <td>Single time series, no external factors</td>
            <td><strong>ARIMA/SARIMA</strong> (Week 7)</td>
            <td>Monthly sales with seasonal pattern</td>
        </tr>
        <tr>
            <td>Y depends on X, but X is external/given</td>
            <td><strong>Regression with lags</strong> (Week 9)</td>
            <td>Sales depend on GDP (which we don't control)</td>
        </tr>
        <tr>
            <td style="background: #FFF5F5;">Multiple variables influencing each other</td>
            <td style="background: #FFF5F5;"><strong>VAR</strong> (Week 8)</td>
            <td style="background: #FFF5F5;">Sales ↔ Inventory ↔ Price all interact</td>
        </tr>
        <tr>
            <td>Need to forecast thousands of series</td>
            <td><strong>Simple methods</strong> (ETS, Prophet)</td>
            <td>Forecast every product SKU in retail chain</td>
        </tr>
        <tr>
            <td>Trend changes frequently</td>
            <td><strong>Prophet</strong> (Week 6)</td>
            <td>Website traffic with changing growth rates</td>
        </tr>
    </table>
    <div class="highlight" style="margin-top: 30px;">
        <strong>Key Principle:</strong> Start simple (ARIMA), then add complexity (VAR) only if it improves forecast accuracy significantly.
    </div>
</div>

<!-- Slide 29: Common Mistakes -->
<div class="slide">
    <h2>Common Mistakes to Avoid</h2>
    <div class="grid-3" style="margin-top: 30px;">
        <div class="box" style="background: #FFE8E8;">
            <h3 style="font-size: 20px; color: #DC143C;">❌ Mistake 1</h3>
            <p style="font-size: 18px;"><strong>Treating Granger causality as proof of real causation</strong></p>
            <p style="font-size: 16px; margin-top: 10px;">Remember: It only tests predictive power, not true causal mechanisms</p>
        </div>
        <div class="box" style="background: #FFE8E8;">
            <h3 style="font-size: 20px; color: #DC143C;">❌ Mistake 2</h3>
            <p style="font-size: 18px;"><strong>Using too many variables in VAR</strong></p>
            <p style="font-size: 16px; margin-top: 10px;">More variables = many more parameters to estimate. Stick to 2-5 key variables</p>
        </div>
        <div class="box" style="background: #FFE8E8;">
            <h3 style="font-size: 20px; color: #DC143C;">❌ Mistake 3</h3>
            <p style="font-size: 18px;"><strong>Forgetting to check stationarity</strong></p>
            <p style="font-size: 16px; margin-top: 10px;">VAR requires stationary data. Always test and difference if needed</p>
        </div>
    </div>
    <div class="grid-3" style="margin-top: 20px;">
        <div class="box" style="background: #FFE8E8;">
            <h3 style="font-size: 20px; color: #DC143C;">❌ Mistake 4</h3>
            <p style="font-size: 18px;"><strong>Using VAR when relationships are one-way</strong></p>
            <p style="font-size: 16px; margin-top: 10px;">If X → Y but not Y → X, regression is simpler and better</p>
        </div>
        <div class="box" style="background: #FFE8E8;">
            <h3 style="font-size: 20px; color: #DC143C;">❌ Mistake 5</h3>
            <p style="font-size: 18px;"><strong>Ignoring forecast uncertainty</strong></p>
            <p style="font-size: 16px; margin-top: 10px;">Always report prediction intervals, not just point forecasts</p>
        </div>
        <div class="box" style="background: #FFE8E8;">
            <h3 style="font-size: 20px; color: #DC143C;">❌ Mistake 6</h3>
            <p style="font-size: 18px;"><strong>Not validating on holdout data</strong></p>
            <p style="font-size: 16px; margin-top: 10px;">Test your model on data it hasn't seen during training</p>
        </div>
    </div>
</div>

<!-- Slide 30: Best Practices -->
<div class="slide">
    <h2>Best Practices for VAR Modeling</h2>
    <div class="two-column" style="margin-top: 30px;">
        <div>
            <h3>Data Preparation</h3>
            <ul style="font-size: 20px;">
                <li>Ensure adequate sample size (at least 40-50 observations)</li>
                <li>Handle missing values carefully</li>
                <li>Check for and address outliers</li>
                <li>Align all series to same frequency</li>
            </ul>
            <h3 style="margin-top: 30px;">Model Selection</h3>
            <ul style="font-size: 20px;">
                <li>Use BIC for lag order selection</li>
                <li>Start with small number of variables</li>
                <li>Consider economic/business theory</li>
                <li>Test model stability</li>
            </ul>
        </div>
        <div>
            <h3>Interpretation</h3>
            <ul style="font-size: 20px;">
                <li>Focus on statistically significant coefficients</li>
                <li>Use Granger causality to understand relationships</li>
                <li>Communicate results in business terms</li>
                <li>Don't overstate causal claims</li>
            </ul>
            <h3 style="margin-top: 30px;">Validation</h3>
            <ul style="font-size: 20px;">
                <li>Split data: train on 80%, test on 20%</li>
                <li>Compare forecast accuracy metrics (RMSE, MAE)</li>
                <li>Benchmark against simpler models</li>
                <li>Monitor forecast performance over time</li>
            </ul>
        </div>
    </div>
</div>

<!-- Slide 31: Real-World Applications -->
<div class="slide">
    <h2>Real-World Business Applications</h2>
    <div style="margin-top: 30px;">
        <div class="example-box">
            <h3 style="font-size: 22px;">Finance: Portfolio Risk Management</h3>
            <p style="font-size: 19px;">Model interactions between stock returns, interest rates, and volatility indices to understand how shocks propagate through financial markets.</p>
        </div>
        <div class="example-box">
            <h3 style="font-size: 22px;">Retail: Inventory Optimization</h3>
            <p style="font-size: 19px;">Forecast sales, inventory levels, and order quantities simultaneously, accounting for how inventory availability affects sales and sales drive reordering.</p>
        </div>
        <div class="example-box">
            <h3 style="font-size: 22px;">Marketing: Campaign Attribution</h3>
            <p style="font-size: 19px;">Understand which marketing channels (email, social, paid search) Granger-cause conversions and how channels interact with each other.</p>
        </div>
        <div class="example-box">
            <h3 style="font-size: 22px;">Economics: Policy Analysis</h3>
            <p style="font-size: 19px;">Model relationships between GDP, unemployment, inflation, and interest rates to simulate effects of policy changes.</p>
        </div>
    </div>
</div>

<!-- Slide 32: Quiz 5 - Comprehensive -->
<div class="slide">
    <h2>Quiz 5: Bringing It All Together</h2>
    <div class="quiz">
        <p style="font-size: 24px; margin-bottom: 20px;">You're analyzing a restaurant chain's data. You have monthly observations of:</p>
        <ul style="font-size: 20px; margin-bottom: 20px;">
            <li>Revenue</li>
            <li>Customer visits</li>
            <li>Marketing spend</li>
            <li>Average meal price</li>
        </ul>
        <p style="font-size: 22px; margin-bottom: 25px;">What is the BEST first step in your analysis?</p>
        <div class="quiz-option" onclick="checkAnswer(this, false, 5)">
            A) Immediately build a VAR(4) model with all four variables
        </div>
        <div class="quiz-option" onclick="checkAnswer(this, false, 5)">
            B) Calculate correlations between all pairs of variables
        </div>
        <div class="quiz-option" onclick="checkAnswer(this, true, 5)">
            C) Test each variable for stationarity and visualize the time series
        </div>
        <div class="quiz-option" onclick="checkAnswer(this, false, 5)">
            D) Run Granger causality tests on all variable pairs
        </div>
        <div class="feedback" id="feedback5"></div>
    </div>
</div>

<!-- Slide 33: Summary -->
<div class="slide">
    <h2>Week 8 Summary</h2>
    <div style="margin-top: 30px;">
        <div class="box" style="background: #FFF5F5; margin-bottom: 20px;">
            <h3 style="font-size: 24px; color: #DC143C;">Key Concepts Learned</h3>
            <ol style="font-size: 20px; margin-top: 15px;">
                <li><strong>Correlation ≠ Causation:</strong> High correlation doesn't imply that one variable causes another</li>
                <li><strong>Granger Causality:</strong> Tests whether past values of X help predict Y (forecasting ability, not true causation)</li>
                <li><strong>VAR Models:</strong> System of equations for forecasting multiple related variables simultaneously</li>
                <li><strong>Feedback Loops:</strong> VAR captures how variables influence each other over time</li>
            </ol>
        </div>
        <div class="two-column">
            <div class="box">
                <h3 style="font-size: 20px;">When to Use VAR</h3>
                <ul style="font-size: 18px;">
                    <li>Multiple variables influence each other</li>
                    <li>Feedback relationships exist</li>
                    <li>Need system-wide forecasts</li>
                    <li>Want to test Granger causality</li>
                </ul>
            </div>
            <div class="box">
                <h3 style="font-size: 20px;">Key Requirements</h3>
                <ul style="font-size: 18px;">
                    <li>Data must be stationary</li>
                    <li>Adequate sample size (40+ obs)</li>
                    <li>Limited number of variables (2-5)</li>
                    <li>Same frequency for all series</li>
                </ul>
            </div>
        </div>
    </div>
</div>

<!-- Slide 34: Next Steps -->
<div class="slide">
    <h2>Looking Ahead: Week 9</h2>
    <div class="highlight" style="margin-top: 30px; font-size: 22px;">
        <strong>Next Week: Regression Models for Forecasting</strong>
        <p style="margin-top: 15px;">We'll explore how to use regression when the relationship is one-directional (X → Y but not Y → X), including:</p>
    </div>
    <div style="margin-top: 40px;">
        <ul style="font-size: 22px;">
            <li>Linear regression with time series data</li>
            <li>Including lagged predictors</li>
            <li>Handling trends and seasonality in regression</li>
            <li>When regression outperforms VAR</li>
            <li>Dynamic regression models</li>
        </ul>
    </div>
    <div class="box" style="margin-top: 50px; background: #FFF9E6; border-color: #FFC107;">
        <h3 style="font-size: 24px;">Prepare for Next Week:</h3>
        <p style="font-size: 20px; margin-top: 10px;">Review your linear regression concepts from previous statistics courses. We'll build on that foundation to create powerful forecasting models.</p>
    </div>
    <div style="text-align: center; margin-top: 60px;">
        <p style="font-size: 28px; color: #DC143C;"><strong>Questions?</strong></p>
    </div>
</div>

<!-- Navigation -->
<div class="navigation">
    <button id="prevBtn" onclick="changeSlide(-1)">Previous</button>
    <button id="nextBtn" onclick="changeSlide(1)">Next</button>
</div>

<div class="slide-number" id="slideNumber"></div>
<div class="logo">DATA4400 | Kaplan Business School</div>

<script>
let currentSlide = 0;
const slides = document.querySelectorAll('.slide');
const totalSlides = slides.length;

function showSlide(n) {
    slides[currentSlide].classList.remove('active');
    currentSlide = (n + totalSlides) % totalSlides;
    slides[currentSlide].classList.add('active');
    
    document.getElementById('slideNumber').textContent = `Slide ${currentSlide + 1} / ${totalSlides}`;
    document.getElementById('prevBtn').disabled = currentSlide === 0;
    document.getElementById('nextBtn').disabled = currentSlide === totalSlides - 1;
    
    // Initialize charts when reaching specific slides
    if (currentSlide === 4) initCorrelationChart();
    if (currentSlide === 13) initGrangerChart();
    if (currentSlide === 23) initVarForecastChart();
}

function changeSlide(direction) {
    showSlide(currentSlide + direction);
}

// Keyboard navigation
document.addEventListener('keydown', function(event) {
    if (event.key === 'ArrowLeft') changeSlide(-1);
    if (event.key === 'ArrowRight') changeSlide(1);
});

// Quiz functionality
function checkAnswer(element, isCorrect, quizNumber) {
    const options = element.parentElement.querySelectorAll('.quiz-option');
    const feedback = document.getElementById(`feedback${quizNumber}`);
    
    // Disable all options after selection
    options.forEach(opt => {
        opt.style.pointerEvents = 'none';
    });
    
    if (isCorrect) {
        element.classList.add('correct');
        feedback.className = 'feedback correct show';
        if (quizNumber === 1) {
            feedback.innerHTML = '<strong>✓ Correct!</strong> Both parking and sales are likely driven by a third factor: store size and location. Larger stores in busier areas naturally have more parking AND higher sales. Building more parking at a small store won\'t increase sales.';
        } else if (quizNumber === 2) {
            feedback.innerHTML = '<strong>✓ Correct!</strong> Random assignment to treatment and control groups is the gold standard for establishing causation. By randomly selecting cities for ads, you control for confounding factors and can isolate the effect of advertising on sales.';
        } else if (quizNumber === 3) {
            feedback.innerHTML = '<strong>✓ Correct!</strong> Granger causality tests predictive relationships, not true causation. The low p-value indicates that including past Twitter activity significantly improves our Bitcoin price forecasts, but this doesn\'t prove Twitter activity causes price changes.';
        } else if (quizNumber === 4) {
            feedback.innerHTML = '<strong>✓ Correct!</strong> With 3 variables and 2 lags, you have 3 equations (one per variable). Each equation includes 3 variables × 2 lags = 6 lagged terms. Total: 3 equations × 6 terms = 18 coefficients (plus 3 constants).';
        } else if (quizNumber === 5) {
            feedback.innerHTML = '<strong>✓ Correct!</strong> Before any modeling, you must understand your data. Testing stationarity and visualizing the series helps you identify trends, seasonality, structural breaks, and whether differencing is needed. This guides all subsequent analysis.';
        }
    } else {
        element.classList.add('incorrect');
        feedback.className = 'feedback incorrect show';
        if (quizNumber === 1) {
            feedback.innerHTML = '<strong>✗ Not quite.</strong> Consider: what factors determine both parking availability and sales volume? Think about confounding variables like store size and location.';
        } else if (quizNumber === 2) {
            feedback.innerHTML = '<strong>✗ Not quite.</strong> While these methods provide some information, they don\'t control for confounding factors. Random assignment is key to establishing causation.';
        } else if (quizNumber === 3) {
            feedback.innerHTML = '<strong>✗ Not quite.</strong> Remember: Granger causality measures predictive power, not true causation. A significant test means X helps forecast Y, not that X causes Y.';
        } else if (quizNumber === 4) {
            feedback.innerHTML = '<strong>✗ Not quite.</strong> Count carefully: 3 equations × 3 variables × 2 lags. Each equation predicts one variable using lagged values of all three variables.';
        } else if (quizNumber === 5) {
            feedback.innerHTML = '<strong>✗ Not quite.</strong> Before building models or running tests, you need to understand your data\'s properties. Stationarity testing and visualization are essential first steps.';
        }
    }
}

// Chart for spurious correlation
function initCorrelationChart() {
    const ctx = document.getElementById('correlationChart');
    if (!ctx || ctx.chart) return;
    
    const years = [];
    for (let i = 2000; i <= 2009; i++) years.push(i);
    
    ctx.chart = new Chart(ctx, {
        type: 'line',
        data: {
            labels: years,
            datasets: [{
                label: 'Divorce Rate (per 1000)',
                data: [5.0, 4.7, 4.6, 4.4, 4.3, 4.1, 4.2, 4.2, 4.1, 3.9],
                borderColor: '#DC143C',
                backgroundColor: 'rgba(220, 20, 60, 0.1)',
                tension: 0.4,
                yAxisID: 'y'
            }, {
                label: 'Margarine Consumption (lbs)',
                data: [8.2, 7.0, 6.5, 5.3, 5.2, 4.0, 4.6, 4.5, 4.2, 3.7],
                borderColor: '#2196F3',
                backgroundColor: 'rgba(33, 150, 243, 0.1)',
                tension: 0.4,
                yAxisID: 'y1'
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            interaction: {
                mode: 'index',
                intersect: false,
            },
            plugins: {
                legend: {
                    labels: { font: { size: 14 } }
                }
            },
            scales: {
                y: {
                    type: 'linear',
                    position: 'left',
                    title: {
                        display: true,
                        text: 'Divorce Rate',
                        font: { size: 14 }
                    }
                },
                y1: {
                    type: 'linear',
                    position: 'right',
                    title: {
                        display: true,
                        text: 'Margarine (lbs)',
                        font: { size: 14 }
                    },
                    grid: {
                        drawOnChartArea: false,
                    }
                }
            }
        }
    });
}

// Chart for Granger causality example
function initGrangerChart() {
    const ctx = document.getElementById('grangerChart');
    if (!ctx || ctx.chart) return;
    
    const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
    
    ctx.chart = new Chart(ctx, {
        type: 'line',
        data: {
            labels: months,
            datasets: [{
                label: 'Social Media Mentions',
                data: [100, 120, 115, 140, 160, 155, 180, 175, 190, 185, 200, 210],
                borderColor: '#DC143C',
                backgroundColor: 'rgba(220, 20, 60, 0.1)',
                tension: 0.4,
                yAxisID: 'y'
            }, {
                label: 'Sales Revenue ($1000s)',
                data: [50, 55, 54, 62, 68, 66, 75, 73, 78, 76, 82, 85],
                borderColor: '#2196F3',
                backgroundColor: 'rgba(33, 150, 243, 0.1)',
                tension: 0.4,
                yAxisID: 'y1'
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            interaction: {
                mode: 'index',
                intersect: false,
            },
            plugins: {
                legend: {
                    labels: { font: { size: 14 } }
                }
            },
            scales: {
                y: {
                    type: 'linear',
                    position: 'left',
                    title: {
                        display: true,
                        text: 'Social Media Mentions',
                        font: { size: 14 }
                    }
                },
                y1: {
                    type: 'linear',
                    position: 'right',
                    title: {
                        display: true,
                        text: 'Sales Revenue ($1000s)',
                        font: { size: 14 }
                    },
                    grid: {
                        drawOnChartArea: false,
                    }
                }
            }
        }
    });
}

// Chart for VAR forecasting
function initVarForecastChart() {
    const ctx = document.getElementById('varForecastChart');
    if (!ctx || ctx.chart) return;
    
    const periods = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
    
    ctx.chart = new Chart(ctx, {
        type: 'line',
        data: {
            labels: periods,
            datasets: [{
                label: 'Actual Sales',
                data: [100, 105, 102, 108, 112, 110, null, null, null, null, null, null],
                borderColor: '#2196F3',
                backgroundColor: 'rgba(33, 150, 243, 0.1)',
                tension: 0.4
            }, {
                label: 'Forecasted Sales',
                data: [null, null, null, null, null, 110, 114, 116, 119, 122, 125, 128],
                borderColor: '#DC143C',
                backgroundColor: 'rgba(220, 20, 60, 0.1)',
                borderDash: [5, 5],
                tension: 0.4
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    labels: { font: { size: 14 } }
                }
            },
            scales: {
                y: {
                    title: {
                        display: true,
                        text: 'Sales ($1000s)',
                        font: { size: 14 }
                    }
                }
            }
        }
    });
}

// Initialize
showSlide(0);
</script>

</body>
</html>